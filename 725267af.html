<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">
  <meta name="google-site-verification" content="Kh9Fd2kRwyC6ZRSU1tw4Hk1EfDKThfkk5HneuPofGfU">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="https://fonts.lug.ustc.edu.cn/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="/lib/pace/pace-theme-material.min.css">
  <script src="/lib/pace/pace.min.js"></script>

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"www.uynajgi.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"utterance","storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="《矩阵计算》学习笔记 (Python 环境)更新中......">
<meta property="og:type" content="article">
<meta property="og:title" content="矩阵计算">
<meta property="og:url" content="https://www.uynajgi.com/725267af.html">
<meta property="og:site_name" content="結凪·Star">
<meta property="og:description" content="《矩阵计算》学习笔记 (Python 环境)更新中......">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.328888.xyz/2022/05/26/lj7tF.jpg">
<meta property="og:image" content="https://s2.loli.net/2022/06/05/XUQpdE7R3CHFPuv.png">
<meta property="og:image" content="https://www.uynajgi.com/Matrixcalculation_files/Matrixcalculation_48_0.png">
<meta property="article:published_time" content="2022-06-12T14:56:25.000Z">
<meta property="article:modified_time" content="2022-06-23T16:15:29.855Z">
<meta property="article:author" content="結凪">
<meta property="article:tag" content="矩阵">
<meta property="article:tag" content="数值计算">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.328888.xyz/2022/05/26/lj7tF.jpg">

<link rel="canonical" href="https://www.uynajgi.com/725267af.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>矩阵计算 | 結凪·Star</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

<style type="text/css">
.spoiler {
  display: inline-flex;
}
p.spoiler {
  display: flex;
}
.spoiler a {
  pointer-events: none;
}
.spoiler-blur, .spoiler-blur > * {
  transition: text-shadow .5s ease;
}
.spoiler .spoiler-blur, .spoiler .spoiler-blur > * {
  color: rgba(0, 0, 0, 0);
  background-color: rgba(0, 0, 0, 0);
  text-shadow: 0 0 10px grey;
  cursor: pointer;
}
.spoiler .spoiler-blur:hover, .spoiler .spoiler-blur:hover > * {
  text-shadow: 0 0 5px grey;
}
.spoiler-box, .spoiler-box > * {
  transition: color .5s ease,
  background-color .5s ease;
}
.spoiler .spoiler-box, .spoiler .spoiler-box > * {
  color: black;
  background-color: black;
  text-shadow: none;
}</style></head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">結凪·Star</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Game of Life</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>文章</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>图书馆</a>

  </li>
        <li class="menu-item menu-item-books">

    <a href="/books/" rel="section"><i class="fa fa-file fa-fw"></i>资源馆</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于我</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://www.uynajgi.com/725267af.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/U_avatar.jpg">
      <meta itemprop="name" content="結凪">
      <meta itemprop="description" content="如果你想走到高处，就要使用自己的两条腿！">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="結凪·Star">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          矩阵计算
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2022-06-12 22:56:25" itemprop="dateCreated datePublished" datetime="2022-06-12T22:56:25+08:00">2022-06-12</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2022-06-24 00:15:29" itemprop="dateModified" datetime="2022-06-24T00:15:29+08:00">2022-06-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">数学</span></a>
                </span>
                  ，
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E5%AD%A6/%E8%AE%A1%E7%AE%97%E6%95%B0%E5%AD%A6/" itemprop="url" rel="index"><span itemprop="name">计算数学</span></a>
                </span>
            </span>

          
            <div class="post-description">《矩阵计算》学习笔记 (Python 环境)<p><b>更新中......</b></div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p>注意！在 <code>python</code> 中，向量在向量相乘时为行向量，在涉及程序运算时，代码存在 $x^Ty$ 为矩阵，$xy^T$ 为内积的情况</p>
<p>为了与普遍教材一致，在其他大部分情况，如 $\mathbf {X} x$ 的情况 $x$ 为列向量，实际情况请根据上下文注意辨别</p>
</blockquote>
<h1 id="矩阵乘法"><a href="#矩阵乘法" class="headerlink" title="矩阵乘法"></a>矩阵乘法</h1><h2 id="基本算法与记号"><a href="#基本算法与记号" class="headerlink" title="基本算法与记号"></a>基本算法与记号</h2><h3 id="矩阵记号"><a href="#矩阵记号" class="headerlink" title="矩阵记号"></a>矩阵记号</h3><h3 id="矩阵运算"><a href="#矩阵运算" class="headerlink" title="矩阵运算"></a>矩阵运算</h3><h3 id="向量记号"><a href="#向量记号" class="headerlink" title="向量记号"></a>向量记号</h3><h3 id="向量运算"><a href="#向量运算" class="headerlink" title="向量运算"></a>向量运算</h3><h3 id="点积和-saxpy-计算"><a href="#点积和-saxpy-计算" class="headerlink" title="点积和 saxpy 计算"></a>点积和 saxpy 计算</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x = np.arange(<span class="number">5</span>)</span><br><span class="line">y = np.arange(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"x = "</span>, x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"y = "</span>, y)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>x =  [0 1 2 3 4]
y =  [1 2 3 4 5]
</code></pre><p><strong>算法 1.1.1（点积）</strong></p>
<p>$c := x^Ty == y^Tx$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">c = np.dot(x, y)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"c = "</span>, c)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>c =  40
</code></pre><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">a = np.array([[<span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">              [<span class="number">3</span>, <span class="number">4</span>]])</span><br><span class="line">b = np.array([[<span class="number">5</span>, <span class="number">6</span>],</span><br><span class="line">              [<span class="number">7</span>, <span class="number">8</span>]])</span><br><span class="line">c = np.matmul(a, b)  <span class="comment"># 矩阵积，但是可以多维按页</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"c"</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">c = np.dot(a, b)  <span class="comment"># 矩阵积</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"c"</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">c = a * b  <span class="comment"># 对应相相乘</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"c"</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br><span class="line">c = np.multiply(a, b)  <span class="comment"># 对应相相乘</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"c"</span>)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>c
[[19 22]
 [43 50]]
c
[[19 22]
 [43 50]]
c
[[ 5 12]
 [21 32]]
c
[[ 5 12]
 [21 32]]
</code></pre><p><strong>算法 1.1.2（saxpy）</strong></p>
<p>$y:=ax+y$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">7</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"y = "</span>, y)</span><br><span class="line">y += a * x</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"y = "</span>, y)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>y =  [1 2 3 4 5]
y =  [ 1  9 17 25 33]
</code></pre><h3 id="矩阵与向量相乘和-gaxpy"><a href="#矩阵与向量相乘和-gaxpy" class="headerlink" title="矩阵与向量相乘和 gaxpy"></a>矩阵与向量相乘和 gaxpy</h3><p>$y:=\mathbf{X}x+y$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">A = np.arange(<span class="number">4</span>*<span class="number">5</span>).reshape(<span class="number">4</span>, <span class="number">5</span>)</span><br><span class="line">x = np.arange(<span class="number">5</span>)</span><br><span class="line">y = np.arange(<span class="number">4</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"x = "</span>, x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"y = "</span>, y)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"A = "</span>, A)</span><br><span class="line">y += np.dot(A, x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"y = "</span>, y)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>x =  [0 1 2 3 4]
y =  [0 1 2 3]
A =  [[ 0  1  2  3  4]
 [ 5  6  7  8  9]
 [10 11 12 13 14]
 [15 16 17 18 19]]
y =  [ 30  81 132 183]
</code></pre><h3 id="矩阵划分成行和列"><a href="#矩阵划分成行和列" class="headerlink" title="矩阵划分成行和列"></a>矩阵划分成行和列</h3><p>按行</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> alpha <span class="keyword">in</span> A:</span><br><span class="line">    <span class="built_in">print</span>(alpha)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[0 1 2 3 4]
[5 6 7 8 9]
[10 11 12 13 14]
[15 16 17 18 19]
</code></pre><p>按列</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> alpha <span class="keyword">in</span> A.T:</span><br><span class="line">    <span class="built_in">print</span>(alpha)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[ 0  5 10 15]
[ 1  6 11 16]
[ 2  7 12 17]
[ 3  8 13 18]
[ 4  9 14 19]
</code></pre><h3 id="冒号记号"><a href="#冒号记号" class="headerlink" title="冒号记号"></a>冒号记号</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">"A 的第一行 = "</span>, A[<span class="number">0</span>, :])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"A 的第一列 = "</span>, A[:, <span class="number">0</span>])</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A 的第一行 =  [0 1 2 3 4]
A 的第一列 =  [ 0  5 10 15]
</code></pre><h3 id="外积修正"><a href="#外积修正" class="headerlink" title="外积修正"></a>外积修正</h3><p>$\mathbf{A}:=\mathbf{A}+xy^T$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = x.reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line"><span class="built_in">print</span>(y)</span><br><span class="line"><span class="built_in">print</span>(x)</span><br><span class="line"><span class="built_in">print</span>(np.dot(x, y.reshape(<span class="number">1</span>, -<span class="number">1</span>)))</span><br><span class="line"><span class="built_in">print</span>(x * y)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[ 30  81 132 183]
[[0]
 [1]
 [2]
 [3]
 [4]]
[[  0   0   0   0]
 [ 30  81 132 183]
 [ 60 162 264 366]
 [ 90 243 396 549]
 [120 324 528 732]]
[[  0   0   0   0]
 [ 30  81 132 183]
 [ 60 162 264 366]
 [ 90 243 396 549]
 [120 324 528 732]]
</code></pre><h3 id="矩阵与矩阵相乘"><a href="#矩阵与矩阵相乘" class="headerlink" title="矩阵与矩阵相乘"></a>矩阵与矩阵相乘</h3><p>$\mathbf{C}_{m\times m}=\mathbf{X}_{m\times n}\mathbf{B}_{n\times m}$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">A = np.random.randint(<span class="number">0</span>, <span class="number">100</span>, (<span class="number">5</span>, <span class="number">4</span>))</span><br><span class="line">B = np.random.randint(<span class="number">0</span>, <span class="number">100</span>, (<span class="number">4</span>, <span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"A = "</span>, A)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"B = "</span>, B)</span><br><span class="line">C = np.dot(A, B)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"C = "</span>, C)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A =  [[37 12 72  9]
 [75  5 79 64]
 [16  1 76 71]
 [ 6 25 50 20]
 [18 84 11 28]]
B =  [[29 14 50 68 87]
 [87 94 96 86 13]
 [ 9  7 63 61 22]
 [57  1  0 60 81]]
C =  [[ 3278  2159  7538  8480  5688]
 [ 6969  2137  9207 14189 13512]
 [ 5282   921  5684 10070  8828]
 [ 3939  2804  5850  6808  3567]
 [ 9525  8253  9657 10799  5168]]
</code></pre><h3 id="标量描述"><a href="#标量描述" class="headerlink" title="标量描述"></a>标量描述</h3><p>$\mathbf{C}:=\mathbf{AB}+\mathbf{C}$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C += np.dot(A, B)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"C = "</span>, C)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>C =  [[ 6556  4318 15076 16960 11376]
 [13938  4274 18414 28378 27024]
 [10564  1842 11368 20140 17656]
 [ 7878  5608 11700 13616  7134]
 [19050 16506 19314 21598 10336]]
</code></pre><h3 id="矩阵方程"><a href="#矩阵方程" class="headerlink" title="矩阵方程"></a>矩阵方程</h3><p><strong>定理 1.1.1</strong> $(\mathbf{AB})^T=\mathbf{B}^T\mathbf{A}^T$</p>
<h3 id="复矩阵"><a href="#复矩阵" class="headerlink" title="复矩阵"></a>复矩阵</h3><p>复矩阵的转置是<strong>转置共轭</strong>：$\mathbf{A}^H=\tilde{a}_{ji}$</p>
<ul>
<li>例题 计算 $\mathbf {M}=\prod {(\mathbf {A}-x_i\mathbf {I})}$</li>
</ul>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">A = np.random.randint(<span class="number">0</span>, <span class="number">5</span>, (<span class="number">5</span>, <span class="number">5</span>))</span><br><span class="line">I = np.eye(<span class="number">5</span>)</span><br><span class="line">M = I[:]</span><br><span class="line">lst = np.random.randint(<span class="number">0</span>, <span class="number">5</span>, (<span class="number">5</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"-"</span> * <span class="number">20</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lst:</span><br><span class="line">    M = np.dot(M, A-i*I)</span><br><span class="line"><span class="built_in">print</span>(M)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"-"</span> * <span class="number">20</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>--------------------
[[2810. 2944. 5216. 4221. 3893.]
 [4360. 3448. 4684. 5240. 5472.]
 [7162. 4676. 5386. 7599. 8592.]
 [5380. 3756. 4870. 5964. 6319.]
 [4846. 4176. 6264. 6043. 6099.]]
--------------------
</code></pre><h2 id="利用结构"><a href="#利用结构" class="headerlink" title="利用结构"></a>利用结构</h2><h3 id="带状矩阵和-X-0-记号"><a href="#带状矩阵和-X-0-记号" class="headerlink" title="带状矩阵和 X-0 记号"></a>带状矩阵和 X-0 记号</h3><p>任何 $i&gt;j+p$ 都有 $a_{ij}=0$，称有下带宽 $p$，任何 $j&gt;i+p$ 都有 $a_{ij}=0$，称有上带宽 $q$</p>
<h3 id="对角矩阵"><a href="#对角矩阵" class="headerlink" title="对角矩阵"></a>对角矩阵</h3><p>上下带宽都为零的矩阵是对角矩阵</p>
<h3 id="三角形矩阵乘法"><a href="#三角形矩阵乘法" class="headerlink" title="三角形矩阵乘法"></a>三角形矩阵乘法</h3><h3 id="flop"><a href="#flop" class="headerlink" title="flop"></a>flop</h3><h3 id="再论冒号记号"><a href="#再论冒号记号" class="headerlink" title="再论冒号记号"></a>再论冒号记号</h3><h3 id="带状矩阵存储"><a href="#带状矩阵存储" class="headerlink" title="带状矩阵存储"></a>带状矩阵存储</h3><h2 id="分块矩阵和算法"><a href="#分块矩阵和算法" class="headerlink" title="分块矩阵和算法"></a>分块矩阵和算法</h2><h3 id="分块矩阵记号"><a href="#分块矩阵记号" class="headerlink" title="分块矩阵记号"></a>分块矩阵记号</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">A = np.eye(<span class="number">2</span>) * <span class="number">2</span></span><br><span class="line">B = np.eye(<span class="number">3</span>) * <span class="number">3</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">"-"</span> * <span class="number">20</span>)</span><br><span class="line">C = np.block([</span><br><span class="line">    [A,               np.zeros((<span class="number">2</span>, <span class="number">3</span>))],</span><br><span class="line">    [np.ones((<span class="number">3</span>, <span class="number">2</span>)), B]</span><br><span class="line">])</span><br><span class="line"><span class="built_in">print</span>(A, <span class="string">"\n"</span>)</span><br><span class="line"><span class="built_in">print</span>(B, <span class="string">"\n"</span>)</span><br><span class="line"><span class="built_in">print</span>(C)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">"-"</span> * <span class="number">20</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>--------------------
[[2. 0.]
 [0. 2.]] 

[[3. 0. 0.]
 [0. 3. 0.]
 [0. 0. 3.]] 

[[2. 0. 0. 0. 0.]
 [0. 2. 0. 0. 0.]
 [1. 1. 3. 0. 0.]
 [1. 1. 0. 3. 0.]
 [1. 1. 0. 0. 3.]]
--------------------
</code></pre><h3 id="分块矩阵乘法"><a href="#分块矩阵乘法" class="headerlink" title="分块矩阵乘法"></a>分块矩阵乘法</h3><h3 id="子矩阵记号"><a href="#子矩阵记号" class="headerlink" title="子矩阵记号"></a>子矩阵记号</h3><h3 id="分块矩阵乘向量"><a href="#分块矩阵乘向量" class="headerlink" title="分块矩阵乘向量"></a>分块矩阵乘向量</h3><h3 id="分块矩阵乘法-1"><a href="#分块矩阵乘法-1" class="headerlink" title="分块矩阵乘法"></a>分块矩阵乘法</h3><h3 id="复矩阵乘法"><a href="#复矩阵乘法" class="headerlink" title="复矩阵乘法"></a>复矩阵乘法</h3><h3 id="“分而治之”矩阵乘法"><a href="#“分而治之”矩阵乘法" class="headerlink" title="“分而治之”矩阵乘法"></a>“分而治之” 矩阵乘法</h3><h2 id="向量化与数据重复使用"><a href="#向量化与数据重复使用" class="headerlink" title="向量化与数据重复使用"></a>向量化与数据重复使用</h2><h1 id="矩阵分析"><a href="#矩阵分析" class="headerlink" title="矩阵分析"></a>矩阵分析</h1><h2 id="线性代数初步"><a href="#线性代数初步" class="headerlink" title="线性代数初步"></a>线性代数初步</h2><h3 id="独立，子空间，基和维数"><a href="#独立，子空间，基和维数" class="headerlink" title="独立，子空间，基和维数"></a>独立，子空间，基和维数</h3><h3 id="域，零空间和秩"><a href="#域，零空间和秩" class="headerlink" title="域，零空间和秩"></a>域，零空间和秩</h3><p>$\dim{(\text{null}(\mathbf{A}))}+r(\mathbf{A})=n$</p>
<h3 id="逆矩阵"><a href="#逆矩阵" class="headerlink" title="逆矩阵"></a>逆矩阵</h3><p><strong>恒等式</strong> $\mathbf{B}^{-1}=\mathbf{A}^{-1}-\mathbf{B}^{-1}(\mathbf{B}-\mathbf{A})\mathbf{A}^{-1}$</p>
<p><strong>Sherman-Morrison-Woodbury 公式</strong> $(\mathbf{A}+\mathbf{UV}^T) = \mathbf{A}^{-1}-\mathbf{A}^{-1}\mathbf{U}(\mathbf{I}+\mathbf{V}^T\mathbf{A}^{-1}\mathbf{U})^{-1}\mathbf{V}^T\mathbf{A}^{-1} $</p>
<h3 id="行列式"><a href="#行列式" class="headerlink" title="行列式"></a>行列式</h3><h3 id="微分"><a href="#微分" class="headerlink" title="微分"></a>微分</h3><p>$\dfrac{\mathrm{d}}{\mathrm{d}\alpha}[\mathbf{A}(\alpha)^{-1}]=-\mathbf{A}(\alpha)^{-1}\left[\dfrac{\mathrm{d}}{\mathrm{d}\alpha}\mathbf{A}(\alpha)\right]\mathbf{A}(\alpha)^{-1}$</p>
<p>$\phi=\dfrac{1}{2}x^T\mathbf{A}x-x^Tb,\quad \nabla\phi=\dfrac{1}{2}(\mathbf{A}^T+\mathbf{A})x-b$</p>
<h2 id="向量范数"><a href="#向量范数" class="headerlink" title="向量范数"></a>向量范数</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>$\parallel x \parallel_p=(\sum{|x_i|^p})^{\frac{1}{p}}$</p>
<p>特别的，当 $p\rightarrow \infty$，$\parallel x \parallel_\infty = \max\{|x_i|\}$</p>
<h3 id="向量范数性质"><a href="#向量范数性质" class="headerlink" title="向量范数性质"></a>向量范数性质</h3><p><strong>Hölder 不等式</strong> $|xy^T|\le ||x||_p||y||_q,\quad \dfrac{1}{p}+\dfrac{1}{q}=1$</p>
<p>当 $p=q=2$ 时，为 Cauchy-Schwartz 不等式</p>
<h3 id="绝对误差和相对误差"><a href="#绝对误差和相对误差" class="headerlink" title="绝对误差和相对误差"></a>绝对误差和相对误差</h3><p>$\varepsilon_{abs}=||\hat {x}-x||$ 为 $\hat {x}$ 的绝对误差，$\varepsilon_{rel}=\dfrac {||\hat {x}-x||}{||x||}$ 为相对误差</p>
<h2 id="矩阵范数"><a href="#矩阵范数" class="headerlink" title="矩阵范数"></a>矩阵范数</h2><h3 id="定义-1"><a href="#定义-1" class="headerlink" title="定义"></a>定义</h3><p><strong>F 范数</strong> $||\mathbf{A}||_F=\sqrt{\sum_{i=1}^m{\sum_{j=1}^n{|a_{ij}|^2}}}=\mathbf{A}\cdot\mathbf{A}$</p>
<p><strong>p 范数</strong> $||\mathbf{A}||_p=\sup_{x\not = 0}{\dfrac{||\mathbf{A}x||_p}{||x||_p}}$</p>
<p>更一般的，$||\mathbf {A}||_{\alpha,\beta}=\sup_{x\not = 0}{\dfrac {||\mathbf {A} x||_\beta}{||x||_\alpha}}$</p>
<h3 id="矩阵范数的一些性质"><a href="#矩阵范数的一些性质" class="headerlink" title="矩阵范数的一些性质"></a>矩阵范数的一些性质</h3><script type="math/tex; mode=display">
|| \mathbf{A}||_2\le|| \mathbf{A}||_F\le\sqrt{n}|| \mathbf{A}||_2</script><script type="math/tex; mode=display">
\max_{i,j}|a_{ij}|\le|| \mathbf{A}||_2\le\sqrt{mn}\max_{i,j}{|a_{ij}|}</script><script type="math/tex; mode=display">
|| \mathbf{A}||_1=\max_{1\le j\le n}\sum_{i=1}^{m}{|a_{ij}|}</script><script type="math/tex; mode=display">
|| \mathbf{A}||_\infty=\max_{1\le i\le m}{\sum_{j=1}^n{|a_{ij}|}}</script><script type="math/tex; mode=display">
\dfrac{1}{\sqrt{n}}|| \mathbf{A}||_\infty\le|| \mathbf{A}||_2\le\sqrt{m}|| \mathbf{A}||_\infty</script><script type="math/tex; mode=display">
\dfrac{1}{\sqrt{m}} || \mathbf{A}||_1\le|| \mathbf{A}||_2\le\sqrt{n}|| \mathbf{A}||_1</script><h3 id="矩阵-2-范数"><a href="#矩阵-2-范数" class="headerlink" title="矩阵 2 范数"></a>矩阵 2 范数</h3><p><strong>定理 2.3.1</strong> 存在 $\{z_n,\  || z||_2=1\}$，使得 $\mathbf {A}^T\mathbf {A} z=\mu^2z$，其中 $\mu=|| A||_2$</p>
<blockquote>
<p>$|| \mathbf {A}||_2$ 是 $\mathbf {A}^T\mathbf {A}$ 矩阵最大特征值的平方根</p>
</blockquote>
<p><strong>推论 2.3.2</strong> $|| \mathbf{A}||_2\le \sqrt{|| \mathbf{A}||_1|| \mathbf{A}||_\infty}$</p>
<h3 id="扰动与逆矩阵"><a href="#扰动与逆矩阵" class="headerlink" title="扰动与逆矩阵"></a>扰动与逆矩阵</h3><p><strong>引理 2.3.3</strong> 若 $\mathbf {F}_n,\ || \mathbf {F}||_p&lt;1,\ \det (\mathbf {I}-\mathbf {F})\not ={0}$</p>
<script type="math/tex; mode=display">
(\mathbf{I}-\mathbf{F})^{-1}=\sum_{k=0}^\infty{\mathbf{F}^k}</script><p>而且</p>
<script type="math/tex; mode=display">
||(\mathbf{I}-\mathbf{F})^{-1} ||_p\le\dfrac{1}{1-|| \mathbf{F}||_p}</script><p><strong>定理 2.3.4</strong> $r=|| \mathbf{A}^{-1}\mathbf{E}||_p&lt;1,\ \det(\mathbf{A}+\mathbf{E})\not ={0}\Rightarrow\ || (\mathbf{A}+\mathbf{E})^{-1}-\mathbf{A}^{-1}||_p\le|| \mathbf{E}||_p|| \mathbf{A}^{-1}||_p^2/(1-r)$</p>
<h2 id="有限精度矩阵计算"><a href="#有限精度矩阵计算" class="headerlink" title="有限精度矩阵计算"></a>有限精度矩阵计算</h2><h2 id="正交化与-SVD"><a href="#正交化与-SVD" class="headerlink" title="正交化与 SVD"></a>正交化与 SVD</h2><h3 id="正交性"><a href="#正交性" class="headerlink" title="正交性"></a>正交性</h3><p>$x_i^Tx_j=\delta_{ij}|x_{ii}|^2$ 称为<strong>正交的</strong>，若 $|x_{ii}|^2=1$，称为<strong>规范正交</strong></p>
<p><strong>定理 2.5.1</strong> 存在一组向量，使得其和规范正交向量组的集合组成正交向量组</p>
<h3 id="范数和正交变换"><a href="#范数和正交变换" class="headerlink" title="范数和正交变换"></a>范数和正交变换</h3><p>2 范数、矩阵 2 范数和 Frobenius 在正交变换下是不变的</p>
<h3 id="奇异值分解"><a href="#奇异值分解" class="headerlink" title="奇异值分解"></a>奇异值分解</h3><p><strong>定理 2.5.2 (奇异值分解 (SVD))</strong> $\mathbf {A}_{m\times n}$，必存在正交矩阵</p>
<script type="math/tex; mode=display">
\mathbf{U}_m=[u_1,...,u_m],\mathbf{V}_n=[v_1,...,v_n]</script><p>使得</p>
<script type="math/tex; mode=display">
\mathbf{U}^T\mathbf{A}\mathbf{V}=\text{diag}(\sigma_1,\cdots,\sigma_p),\quad p=\min\{m,n\}</script><p>写成向量形式有</p>
<script type="math/tex; mode=display">
\mathbf{A}=\sum_{i=1}^r{\sigma_iu_iv_i^T}</script><h3 id="细-SVD"><a href="#细-SVD" class="headerlink" title="细 SVD"></a>细 SVD</h3><p>$\mathbf{U}_m\rightarrow \mathbf{U}_1=\mathbf{U}(:,1:n)$</p>
<p>$\mathbf{\Sigma}_m\rightarrow \mathbf{\Sigma}_1=\mathbf{\Sigma}(1:n,1:n)$</p>
<h3 id="秩亏损与-SVD"><a href="#秩亏损与-SVD" class="headerlink" title="秩亏损与 SVD"></a>秩亏损与 SVD</h3><p><strong>定理 2.5.3</strong> 若 $k&lt;r=r (\mathbf {A})$，且</p>
<script type="math/tex; mode=display">
\mathbf{A}_k=\sum_{i=1}^k{\sigma_iu_iv_i^T}</script><p>则</p>
<script type="math/tex; mode=display">
\min_{r(\mathbf{B}=k)}{|| \mathbf{A}-\mathbf{B}||_2}=|| \mathbf{A}-\mathbf{A}_k||_2=\sigma_{k+1}</script><h3 id="酉矩阵"><a href="#酉矩阵" class="headerlink" title="酉矩阵"></a>酉矩阵</h3><script type="math/tex; mode=display">
\mathbf{Q}^H\mathbf{Q}=\mathbf{I}</script><h2 id="投影与-CS-分解"><a href="#投影与-CS-分解" class="headerlink" title="投影与 CS 分解"></a>投影与 CS 分解</h2><h3 id="正交投影"><a href="#正交投影" class="headerlink" title="正交投影"></a>正交投影</h3><p>若 $\mathbf {P}$ 满足 $\text {ran}(\mathbf {P})=\mathbf {S},\ \mathbf {P}^2=\mathbf {P},\ \mathbf {P}^T=\mathbf {P}$，称 $\mathbf {P}$ 是 $\mathbf {S}$ 上的正交投影</p>
<script type="math/tex; mode=display">
||(\mathbf{P}_1-\mathbf{P}_2)z||^2_2=(\mathbf{P}_1z)^T(\mathbf{I}-\mathbf{P}_2)z+(\mathbf{P}_2z)^T(\mathbf{I}-\mathbf{P}_1)z</script><script type="math/tex; mode=display">
\mathbf{P}=\mathbf{V}\mathbf{V}^T=vv^T/v^Tv</script><h3 id="SVD-相关的投影"><a href="#SVD-相关的投影" class="headerlink" title="SVD 相关的投影"></a>SVD 相关的投影</h3><script type="math/tex; mode=display">
\mathbf{U}=[\mathbf{U}_r\quad \mathbf{\tilde{U}}_r],\quad\mathbf{V}=[\mathbf{V}_r\quad \mathbf{\tilde{V}}_r],</script><p>$\mathbf {V}_r\mathbf {V}_r^T$ 是 $\text {null}(\mathbf {A})^{\perp}=\text {ran}(\mathbf {A}^T)$ 上的正交投影</p>
<p>$\mathbf {\tilde {V}}_r\mathbf {\tilde {V}}_r^T$ 是 $\text {null}(\mathbf {A})$ 上的正交投影</p>
<p>$\mathbf {U}_r\mathbf {U}_r^T$ 是 $\text {ran}(\mathbf {A})$ 上的正交投影</p>
<p>$\mathbf {\tilde {U}}_r\mathbf {\tilde {U}}_r^T$ 是 $\text {ran}(\mathbf {A})^{\perp}=\text {null}(\mathbf {A}^T)$ 上的正交投影</p>
<p><img src="https://s1.328888.xyz/2022/05/26/lj7tF.jpg" alt="lj7tF.jpg"></p>
<h3 id="子空间之间的距离"><a href="#子空间之间的距离" class="headerlink" title="子空间之间的距离"></a>子空间之间的距离</h3><script type="math/tex; mode=display">
\text{dist}(S_1,S_2)=||\mathbf{P}_1-\mathbf{P}_2||_2</script><p><strong>定理 2.6.1</strong> 设</p>
<script type="math/tex; mode=display">
\mathbf{W}=[\mathbf{W}_1(k),\mathbf{W}_2(n-k)],\quad\mathbf{Z}=[\mathbf{Z}_1(k),\mathbf{Z}_2(n-k)]</script><p>都是 $n\times n$ 正交矩阵，如果 $\mathbf {S}_1=\text {ran}(\mathbf {W}_1)$ 和 $\mathbf {S}_2=\text {ran}(\mathbf {Z}_1)$，则</p>
<script type="math/tex; mode=display">
\text{dist}(S_1,S_2)=||\mathbf{W}_1^T\mathbf{Z}_2||_2=||\mathbf{Z}_1^T\mathbf{W}_2||_2</script><h3 id="CS-分解"><a href="#CS-分解" class="headerlink" title="CS 分解"></a>CS 分解</h3><p><strong>定理 2.6.2 (CS 分解 (细形式))</strong> 考虑矩阵</p>
<script type="math/tex; mode=display">
\mathbf{Q}=\left(\begin{matrix}\mathbf{Q}_1\\\mathbf{Q}_2\end{matrix}\right),\ {\mathbf{Q}_1}_{m_1\times n},\ {\mathbf{Q}_2}_{m_2\times n}[m_1,m_2\ge n]</script><p>存在正交矩阵 ${\mathbf {U}_1}_{m_1\times m_1},{\mathbf {U}_2}_{m_2\times m_2},{\mathbf {V}_1}_{n\times n}$，使得</p>
<script type="math/tex; mode=display">
\left(\begin{matrix}\mathbf{U}_1&0\\0&\mathbf{U}_2\end{matrix}\right)^T\left(\begin{matrix}\mathbf{Q}_1\\\mathbf{Q}_2\end{matrix}\right)\mathbf{V}_1=\left(\begin{matrix}\mathbf{C}\\\mathbf{S}\end{matrix}\right)</script><p>其中</p>
<script type="math/tex; mode=display">
\mathbf{C}=\text{diag}(\cos(\theta_1),\cdots,\cos(\theta_n)),</script><script type="math/tex; mode=display">
\mathbf{S}=\text{diag}(\sin(\theta_1),\cdots,\sin(\theta_n)),</script><p><strong>定理 2.6.3 (CS 分解 (一般形式))</strong> 如果</p>
<script type="math/tex; mode=display">
\mathbf{Q}=\left(\begin{matrix}\mathbf{Q}_{11}&\mathbf{Q}_{12}\\\mathbf{Q}_{21}&\mathbf{Q}_{22}\end{matrix}\right)</script><p>存在正交矩阵</p>
<script type="math/tex; mode=display">
\mathbf{U}=\left(\begin{matrix}\mathbf{U}_{1}&\mathbf{O}\\\mathbf{O}&\mathbf{U}_{2}\end{matrix}\right),\quad \mathbf{V}=\left(\begin{matrix}\mathbf{V}_{1}&\mathbf{O}\\\mathbf{O}&\mathbf{V}_{2}\end{matrix}\right)</script><p>使得</p>
<script type="math/tex; mode=display">
\mathbf{U}^T\mathbf{Q}\mathbf{V}=\left(\begin{matrix}
\mathbf{I}&0&0&0&0&0\\
0&\mathbf{C}&0&0&\mathbf{S}&0\\
0&0&0&0&0&\mathbf{I}\\
0&0&0&\mathbf{I}&0&0\\
0&\mathbf{S}&0&0&-\mathbf{C}&0\\
0&0&\mathbf{I}&0&0&0
\end{matrix}\right)</script><h2 id="正方形线性方程组的敏感性"><a href="#正方形线性方程组的敏感性" class="headerlink" title="正方形线性方程组的敏感性"></a>正方形线性方程组的敏感性</h2><h3 id="SVD-分析"><a href="#SVD-分析" class="headerlink" title="SVD 分析"></a>SVD 分析</h3><script type="math/tex; mode=display">
\mathbf{A}=\sum_{i=1}^n{\sigma_iu_iv_i^T}=\mathbf{U\varSigma}\mathbf{V}^T</script><p>则</p>
<script type="math/tex; mode=display">
x=\mathbf{A}^{-1}b=(\mathbf{U\varSigma}\mathbf{V}^T)^{-1}b=\sum_{i=1}^n{\dfrac{u_i^Tb}{\sigma_i}v_i}</script><h3 id="条件"><a href="#条件" class="headerlink" title="条件"></a>条件</h3><p>线性方程组敏感性的一个精确的度量可通过研究带参数方程组</p>
<script type="math/tex; mode=display">
(\mathbf{A}+\varepsilon\mathbf{F})x(\varepsilon)=b+\varepsilon f,\quad x(0)=x</script><p>于是，$x (\varepsilon)$ 的 TayLor 级数展开具有形式</p>
<script type="math/tex; mode=display">
x(\varepsilon)=x+\varepsilon\dot{x}(0)+O(\varepsilon^2)</script><p>其中 $\dot {x}(0)=\mathbf {A}^{-1}[f-\mathbf {F} x]$，可得</p>
<script type="math/tex; mode=display">
\dfrac{|| x(\varepsilon)-x||}{|| x||}\le || \mathbf{A}^{-1}||\left\{\dfrac{|| f||}{|| x||}+|| \mathbf{F}||\right\}+O(\varepsilon^2)</script><p>对于方阵 $\mathbf {A}$，<strong>条件数</strong> $\kappa (\mathbf {A})$ 定义为</p>
<script type="math/tex; mode=display">
\kappa(\mathbf{A})=|| \mathbf{A}|||| \mathbf{A}^{-1}||</script><p>可得</p>
<script type="math/tex; mode=display">
\dfrac{|| x(\varepsilon)-x||}{|| x||}\le || \kappa(\mathbf{A})||(\rho_A+\rho_b)+O(\varepsilon^2)</script><p>其中 $\rho_A=|\varepsilon|\dfrac {|| \mathbf {F}||}{|| \mathbf {A}||},\ \rho_b=|\varepsilon|\dfrac {|| f||}{|| b||}$，分别表示 $\mathbf {A}$ 和 $b$ 的相对误差。</p>
<p>如果 $\kappa (\mathbf {A})$ 大，则称 $\mathbf {A}$ 是<strong>病态矩阵</strong>。</p>
<h3 id="行列式与靠近奇异的程度"><a href="#行列式与靠近奇异的程度" class="headerlink" title="行列式与靠近奇异的程度"></a>行列式与靠近奇异的程度</h3><p>行列式和条件数无关</p>
<h3 id="一个精确的范数界"><a href="#一个精确的范数界" class="headerlink" title="一个精确的范数界"></a>一个精确的范数界</h3><p><strong>引理 2.7.1</strong> 假设</p>
<script type="math/tex; mode=display">
\begin{align*}
    &\mathbf{A}x=b\\
    &(\mathbf{A}+\Delta\mathbf{A})y=b+\Delta b
\end{align*}</script><p>其中 $|| \Delta\mathbf {A}||\le \varepsilon|| \mathbf {A}||,\quad || \Delta b||\le\varepsilon|| b||$，若 $\varepsilon \kappa (\mathbf {A})=r&lt;1$，则 $\mathbf {A}+\Delta\mathbf {A}$ 非奇异且</p>
<script type="math/tex; mode=display">
\dfrac{|| y||}{|| x||}\le\dfrac{1+r}{1-r}</script><p><strong>定理 2.7.2</strong> 如引理 2.7.1 中的条件满足，则</p>
<script type="math/tex; mode=display">
\dfrac{|| y-x||}{|| x||}\le \dfrac{2\varepsilon}{1-r}\kappa(\mathbf{A})</script><h3 id="一些关于分量的精确界"><a href="#一些关于分量的精确界" class="headerlink" title="一些关于分量的精确界"></a>一些关于分量的精确界</h3><p><strong>定理 2.7.3</strong> 假设</p>
<script type="math/tex; mode=display">
\begin{align*}
    &\mathbf{A}x=b\\
    &(\mathbf{A}+\Delta\mathbf{A})y=b+\Delta b
\end{align*}</script><p>其中 $|| \Delta\mathbf {A}||\le \varepsilon|| \mathbf {A}||,\quad || \Delta b||\le\varepsilon|| b||$，若 $\varepsilon \kappa_\infty (\mathbf {A})=r&lt;1$，则 $\mathbf {A}+\Delta\mathbf {A}$ 非奇异且</p>
<script type="math/tex; mode=display">
\dfrac{|| y-x||}{|| x||}\le \dfrac{2\varepsilon}{1-r}|| |\mathbf{A}^{-1}||\mathbf{A}|||_\infty</script><p>我们把 $|| |\mathbf {A}^{-1}||\mathbf {A}|||_\infty$ 称 Skeel 条件数。</p>
<h1 id="一般线性方程组"><a href="#一般线性方程组" class="headerlink" title="一般线性方程组"></a>一般线性方程组</h1><h2 id="三角方程组"><a href="#三角方程组" class="headerlink" title="三角方程组"></a>三角方程组</h2><h3 id="向前消去法"><a href="#向前消去法" class="headerlink" title="向前消去法"></a>向前消去法</h3><p>$2\times 2$ 下三角方程组有</p>
<script type="math/tex; mode=display">
\begin{align*}
    &x_1=b_1/l_{11}\\
    &x_2=(b_2-l_{21}x_1)/l_{22}
\end{align*}</script><p>它的一般形式为</p>
<script type="math/tex; mode=display">
x_i=(b_i-\sum_{j=1}^{i-1}{l_{ij}x_j})/l_{ii}</script><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_forward</span>(<span class="params">L, b</span>):</span><br><span class="line">    L = L.astype(<span class="built_in">float</span>)</span><br><span class="line">    b = b.astype(<span class="built_in">float</span>)</span><br><span class="line">    n = L.shape[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        b[i] = b[i]/L[i,i]</span><br><span class="line">        b[i+<span class="number">1</span>:] = b[i+<span class="number">1</span>:] - b[i]*L[i+<span class="number">1</span>:,i]</span><br><span class="line">    b[n-<span class="number">1</span>] = b[n-<span class="number">1</span>]/L[n-<span class="number">1</span>,n-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> b</span><br></pre></td></tr></tbody></table></figure>
<h3 id="向后消去法"><a href="#向后消去法" class="headerlink" title="向后消去法"></a>向后消去法</h3><p>上三角情况下，一般形式为</p>
<script type="math/tex; mode=display">
x_i=(b_i-\sum_{j=i+1}^{n}{u_{ij}x_j})/u_{ii}</script><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">solve_backward</span>(<span class="params">U, b</span>):</span><br><span class="line">    U = U.astype(<span class="built_in">float</span>)</span><br><span class="line">    b = b.astype(<span class="built_in">float</span>)</span><br><span class="line">    n = U.shape[<span class="number">0</span>]</span><br><span class="line">    b[n-<span class="number">1</span>] /= U[n-<span class="number">1</span>,n-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        b[i] = (b[i]-U[i,i+<span class="number">1</span>:]@b[i+<span class="number">1</span>:].reshape(-<span class="number">1</span>, <span class="number">1</span>))/U[i,i]</span><br><span class="line">    <span class="keyword">return</span> b</span><br></pre></td></tr></tbody></table></figure>
<h3 id="基于列的形式"><a href="#基于列的形式" class="headerlink" title="基于列的形式"></a>基于列的形式</h3><h3 id="多右端项问题"><a href="#多右端项问题" class="headerlink" title="多右端项问题"></a>多右端项问题</h3><h3 id="3-级比例"><a href="#3-级比例" class="headerlink" title="3 级比例"></a>3 级比例</h3><h3 id="求解非方的三角方程组"><a href="#求解非方的三角方程组" class="headerlink" title="求解非方的三角方程组"></a>求解非方的三角方程组</h3><script type="math/tex; mode=display">
\left(\begin{matrix}\mathbf{L}_{11}\\\mathbf{L}_{21}\end{matrix}\right)x=\left(\begin{matrix}b_1\\b_2\end{matrix}\right),\quad \left[\mathbf{L}_{11}\in \mathbb{R}^{n\times n},\mathbf{L}_{21}\in \mathbb{R}^{(m-n)\times n}\right]</script><p>先求 $\mathbf {L}_{11} x=b_1$ 求出 $x$，再代入 $\mathbf {L}_{21}(\mathbf {L}_{11}^{-1} b_1)=b_2$ 则得出解，若无解，可以用最小二乘法适恰。</p>
<h3 id="单位三角方程组"><a href="#单位三角方程组" class="headerlink" title="单位三角方程组"></a>单位三角方程组</h3><p>单位三角形矩阵是指对角线元素全为 1 的三角形矩阵</p>
<h3 id="三角形矩阵的代数"><a href="#三角形矩阵的代数" class="headerlink" title="三角形矩阵的代数"></a>三角形矩阵的代数</h3><ul>
<li>上（下）三角形矩阵的逆是上（下）三角形矩阵</li>
<li>两个上（下）三角形矩阵之积是上（下）三角形矩阵</li>
<li>单位上（下）三角形矩阵之逆是单位上（下）三角形矩阵。</li>
<li>两个单位上（下）三角形矩阵之积是单位上（下）三角形矩阵</li>
</ul>
<h2 id="LU-分解"><a href="#LU-分解" class="headerlink" title="LU 分解"></a>LU 分解</h2><p>此算法求出一个单位下三角形矩阵 $\mathbf {L}$ 和一个上三角形矩阵 $\mathbf {U}$ 使得 $\mathbf {A}=\mathbf {LU}$，</p>
<script type="math/tex; mode=display">
\mathbf{L}y=b,\quad \mathbf{U}x=y\Rightarrow \mathbf{A}x=\mathbf{LU}x=\mathbf{L}y=b</script><h3 id="高斯变换"><a href="#高斯变换" class="headerlink" title="高斯变换"></a>高斯变换</h3><p>如果 $\tau^T=(0,\cdots,0,\tau_{k+1},\cdots,\tau_n),\quad \tau_i=\dfrac {x_i}{x_k},\quad i=k+1:n$，且我们定义</p>
<script type="math/tex; mode=display">
\mathbf{M}_k=\mathbf{I}-\tau e_k^T</script><p>则</p>
<center>
    <img style="border-radius: 0.3125em;
    box-shadow: 0 2px 4px 0 rgba(34,36,38,.12),0 2px 10px 0 rgba(34,36,38,.08);" src="https://s2.loli.net/2022/06/05/XUQpdE7R3CHFPuv.png">
    <br>
    <div style="color:orange;
    border-bottom: 1px solid #d9d9d9;
    display: inline-block;
    color: #999;
    padding: 2px;"></div>
</center>

<p>$\tau_{k+1:n}$ 称为乘子，$\tau$ 称为高斯向量</p>
<h3 id="作用高斯变换"><a href="#作用高斯变换" class="headerlink" title="作用高斯变换"></a>作用高斯变换</h3><h3 id="高斯变换的舍入误差性质"><a href="#高斯变换的舍入误差性质" class="headerlink" title="高斯变换的舍入误差性质"></a>高斯变换的舍入误差性质</h3><h3 id="上三角形化"><a href="#上三角形化" class="headerlink" title="上三角形化"></a>上三角形化</h3><h3 id="LU-分解-1"><a href="#LU-分解-1" class="headerlink" title="LU 分解"></a>LU 分解</h3><script type="math/tex; mode=display">
\begin{align*}
    &\mathbf{U}=\mathbf{M}_1\cdots\mathbf{M}_{n-1}\mathbf{A}\\
    &\mathbf{L}=\mathbf{M}_1^{-1}\cdots\mathbf{M}_{n-1}^{-1}=\mathbf{I}+\sum_{k=1}^{n-1}{\tau^{(k)}e_k^T}\\
    &\mathbf{M}_k=\mathbf{I}-\tau e_k^T,\quad\mathbf{M}_k^{-1}=\mathbf{I}+\tau e_k^T
\end{align*}</script><p><strong>定理 3.2.1</strong> 如果对 $k=1:n-1$，行列式 $\det (A (1:k,1:k))\not ={0}$，则有 LU 分解。如果 $\mathbf {A}$ 非奇异，则 LU 分解是唯一的，且 $\det (\mathbf {A})=\prod {u_{ii}}$</p>
<h3 id="解线性方程组"><a href="#解线性方程组" class="headerlink" title="解线性方程组"></a>解线性方程组</h3><h3 id="分块-LU"><a href="#分块-LU" class="headerlink" title="分块 LU"></a>分块 LU</h3><script type="math/tex; mode=display">
\mathbf{A}=\left(\begin{matrix}\mathbf{A}_{11}&\mathbf{A}_{12}\\\mathbf{A}_{21}&\mathbf{A}_{22}\end{matrix}\right)=\left(\begin{matrix}\mathbf{L}_{11}&0\\\mathbf{L}_{21}&\mathbf{I}_{n-r}\end{matrix}\right)\left(\begin{matrix}\mathbf{I}_r&0\\0&\mathbf{\tilde{A}}\end{matrix}\right)\left(\begin{matrix}\mathbf{U}_{11}&\mathbf{U}_{12}\\0&\mathbf{I}_{n-r}\end{matrix}\right)</script><p>其中 $\mathbf {\tilde {A}}=\mathbf {A}_{22}-\mathbf {L}_{21}\mathbf {U}_{12}$</p>
<h2 id="高斯消去法的舍入误差分析"><a href="#高斯消去法的舍入误差分析" class="headerlink" title="高斯消去法的舍入误差分析"></a>高斯消去法的舍入误差分析</h2><h3 id="LU-分解的误差"><a href="#LU-分解的误差" class="headerlink" title="LU 分解的误差"></a>LU 分解的误差</h3><p><strong>定理 3.3.1</strong> 假定 $\mathbf {A}$ 是一个 $n\times n$ 浮点矩阵。如果算法 3.2.3 中不出现零主元情况，则计算出来的三角形矩阵 $\mathbf {\hat {L}}$ 和 $\mathbf {\hat {U}}$ 满足</p>
<script type="math/tex; mode=display">
\mathbf{L}\mathbf{U}=\mathbf{A}+\mathbf{H}</script><script type="math/tex; mode=display">
|\mathbf{H}|\le 3(n-1)u(|\mathbf{A}|+|\mathbf{\hat{L}}||\mathbf{\hat{U}}|)+O(u^2)</script><h3 id="非精确三角方程组的求解"><a href="#非精确三角方程组的求解" class="headerlink" title="非精确三角方程组的求解"></a>非精确三角方程组的求解</h3><p><strong>定理 3.3.2</strong> 设 $\mathbf {\hat {L}}$ 和 $\mathbf {\hat {U}}$ 是 $n\times n$ 浮点矩阵 $\mathbf {A}$ 通过算法 3.2.3 或算法 3.2.4 所求得的 LU 因子，假设 3.1 节中的方法用来计算 $\mathbf {\hat {L}} y=b$ 和 $\mathbf {\hat {U}} x=\hat {y}$ 之解 $\hat {y}$ 和 $x$ 则 $(\mathbf {A}+\mathbf {E})\hat {x}=b$，其中</p>
<script type="math/tex; mode=display">
|\mathbf{E}|\le nu(3|\mathbf{A}|+5|\mathbf{\hat{L}}||\mathbf{\hat{U}}|)+O(u^2)</script><h2 id="选主元法"><a href="#选主元法" class="headerlink" title="选主元法"></a>选主元法</h2><h3 id="置换矩阵"><a href="#置换矩阵" class="headerlink" title="置换矩阵"></a>置换矩阵</h3><p>一个置换矩阵就是把单位矩阵的行重新排列后所得的矩阵</p>
<h3 id="列选主元：基本思想"><a href="#列选主元：基本思想" class="headerlink" title="列选主元：基本思想"></a>列选主元：基本思想</h3><p>为了使第 $k$ 个高斯变换乘子尽可能小，我们用行互换使 $a_{kk}$ 是第 $k$ 列 $(k:n)$ 行中最大的元素</p>
<h3 id="列选主元：细节"><a href="#列选主元：细节" class="headerlink" title="列选主元：细节"></a>列选主元：细节</h3><p><strong>算法 3.4.1</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># np.random.seed(1)</span></span><br><span class="line">A = np.array([[<span class="number">3</span>, <span class="number">17</span>, <span class="number">10</span>], [<span class="number">2</span>, <span class="number">4</span>, -<span class="number">2</span>], [<span class="number">6</span>, <span class="number">18</span>, -<span class="number">12</span>]])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'A='</span>, A)</span><br><span class="line">k = A.shape[<span class="number">0</span>]</span><br><span class="line">p = []</span><br><span class="line">P = np.eye(A.shape[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> np.arange(k-<span class="number">1</span>):</span><br><span class="line">    p.append(np.argmax(A[j:, j])+j)</span><br><span class="line">    A[[j, p[j]], j:] = A[[p[j], j], j:]  <span class="comment"># 交换行</span></span><br><span class="line">    P[[j, p[j]], :] = P[[p[j], j], :]  <span class="comment"># 交换行</span></span><br><span class="line">    <span class="keyword">if</span> A[j, j] != <span class="number">0</span>:</span><br><span class="line">        rows = <span class="built_in">slice</span>(j+<span class="number">1</span>, k)  <span class="comment"># 切片索引</span></span><br><span class="line">        A[rows, j] = A[rows, j]/A[j, j]</span><br><span class="line">        A[rows, rows] = A[rows, rows] - A[rows, j].reshape(-<span class="number">1</span>, <span class="number">1</span>) * A[j, rows]</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>A= [[  3.  17.  10.]
 [  2.   4.  -2.]
 [  6.  18. -12.]]
</code></pre><h1 id="特殊线性方程组"><a href="#特殊线性方程组" class="headerlink" title="特殊线性方程组"></a>特殊线性方程组</h1><h2 id="LDM-T-和-LDL-T-分解"><a href="#LDM-T-和-LDL-T-分解" class="headerlink" title="$LDM^T$和$LDL^T$分解"></a>$LDM^T$ 和 $LDL^T$ 分解</h2><h3 id="LDM-T-分解"><a href="#LDM-T-分解" class="headerlink" title="$LDM^T$分解"></a>$LDM^T$ 分解</h3><p><strong>定理 4.1.1</strong> 如果 $\mathbf {A}\in \mathbb {R}^{n\times n}$ 的所以顺序主子矩阵都是非奇异的的，则存在唯一的单位下三角矩阵 $\mathbf {L}$ 和 $\mathbf {M}$ 以及唯一的对角矩阵 $\mathbf {D}=\text {diag}(d_1,\dots,d_n)$ 满足 $\mathbf {A}=\mathbf {LD}\mathbf {M}^T$</p>
<h3 id="对称性和-LDL-T-分解"><a href="#对称性和-LDL-T-分解" class="headerlink" title="对称性和$LDL^T$分解"></a>对称性和 $LDL^T$ 分解</h3><p><strong>定理 4.1.2</strong><br>如果 $\mathbf {A}=\mathbf {LD}\mathbf {M}^T$ 是非奇异对称矩阵 $\mathbf {A}$ 的 $LDM^T$ 分解，则 $\mathbf {L}=\mathbf {M}$</p>
<h2 id="正定方程组"><a href="#正定方程组" class="headerlink" title="正定方程组"></a>正定方程组</h2><h3 id="正定性"><a href="#正定性" class="headerlink" title="正定性"></a>正定性</h3><p><strong>定理 4.2.1</strong> 如果 $\mathbf {A}^{(n\times n)}$ 是正定的，$\mathbf {X}^{(n\times k)}$ 的秩为 $k$，则 $\mathbf {B}=\mathbf {X}^T\mathbf {AX}$ 也是正定的<br><strong>推论 4.2.2</strong> 如果 $\mathbf {A}$ 是正定的，则其所有的主子矩阵均为正定的。特别地，所有的对角元均大于零<br><strong>推论 4.2.3</strong> 如果 $\mathbf {A}$ 是正定的，则 $\mathbf {A}$ 的分解 $mathbf {A}=\mathbf {LD}\mathbf {M}^T$ 存在，且 $\mathbf {D}=\text {diag}(d_1,\dots,d_n)$ 的对角元均大于零</p>
<h3 id="非对称正定方程组"><a href="#非对称正定方程组" class="headerlink" title="非对称正定方程组"></a>非对称正定方程组</h3><p><strong>定理 4.2.4</strong> 假设 $\mathbf {A}^{(n\times n)}$ 是正定的，令 $\mathbf {T}=(\mathbf {A}+\mathbf {A}^T)/2,\mathbf {S}=(\mathbf {A}-\mathbf {A}^T)/2$，如果 $\mathbf {A}=\mathbf {LD}\mathbf {M}^T$，则</p>
<script type="math/tex; mode=display">
|||\mathbf{L}||\mathbf{D}||\mathbf{M}^T|||_F\le n(||\mathbf{T}||_2+||\mathbf{S}\mathbf{T}^{-1}\mathbf{S}||_2)</script><p>只要 $\Omega=\dfrac {||\mathbf {S}\mathbf {T}^{-1}\mathbf {S}||_2}{||\mathbf {A}||_2}$，不太大，则不选主元是安全的</p>
<h3 id="对称正定方程组"><a href="#对称正定方程组" class="headerlink" title="对称正定方程组"></a>对称正定方程组</h3><p><strong>定理 4.2.5 (Cholesky 分解)</strong> 如果 $\mathbf {A}^{(n\times n)}$ 是对称正定的，则存在唯一的一个对角元全部大于零的下三角形矩阵 $\mathbf {G}^{(n\times n)}$，满足 $\mathbf {A}=\mathbf {GG}^T$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">A = np.array([[<span class="number">2</span>, -<span class="number">2</span>], [-<span class="number">2</span>, <span class="number">5</span>]])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line">v = np.zeros(A.shape[<span class="number">0</span>])</span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(A.shape[<span class="number">0</span>]):</span><br><span class="line">    <span class="keyword">if</span> j &gt; <span class="number">0</span>:</span><br><span class="line">        A[j:, j] -= A[j:, :j-<span class="number">1</span>]@A[j, :j-<span class="number">1</span>].T</span><br><span class="line">    A[j:, j] /= np.sqrt(A[j, j])</span><br><span class="line">G = np.tril(A, <span class="number">0</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="基于外积的-Cholesky-分解"><a href="#基于外积的-Cholesky-分解" class="headerlink" title="基于外积的 Cholesky 分解"></a>基于外积的 Cholesky 分解</h3><script type="math/tex; mode=display">
\begin{align*}
    \mathbf{A}&=\left(\begin{matrix}\alpha&v^T\\v&\mathbf{B}\end{matrix}\right)=\left(\begin{matrix}\beta&0\\v/\beta&\mathbf{I}_{n-1}\end{matrix}\right)\left(\begin{matrix}1&0\\0&\mathbf{B}-vv^T/\alpha\end{matrix}\right)\left(\begin{matrix}\beta&v^T/\beta\\0&\mathbf{I}_{n-1}\end{matrix}\right)\\&\Rightarrow \mathbf{G}=\left(\begin{matrix}\beta&0\\v/\beta&\mathbf{G}_1\end{matrix}\right)
\end{align*}</script><p>可用递归求解 $\mathbf {G}$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">Cholesky</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="keyword">if</span> A.shape[<span class="number">0</span>] &gt; <span class="number">1</span>:</span><br><span class="line">        G = np.zeros_like(A)</span><br><span class="line">        alpha = A[<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        v = A[<span class="number">1</span>:, <span class="number">0</span>]</span><br><span class="line">        beta = np.sqrt(alpha)</span><br><span class="line">        G[<span class="number">0</span>, <span class="number">0</span>] = beta</span><br><span class="line">        G[<span class="number">1</span>:, <span class="number">0</span>] = v/beta</span><br><span class="line">        G[<span class="number">1</span>:, <span class="number">1</span>:] = Cholesky(A[<span class="number">1</span>:, <span class="number">1</span>:]-v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*v/alpha)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> np.sqrt(A)</span><br><span class="line">    <span class="keyword">return</span> G</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rvs</span>(<span class="params">dim=<span class="number">3</span></span>):</span><br><span class="line">    random_state = np.random</span><br><span class="line">    H = np.eye(dim)</span><br><span class="line">    D = np.ones((dim,))</span><br><span class="line">    <span class="keyword">for</span> n <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, dim):</span><br><span class="line">        x = random_state.normal(size=(dim-n+<span class="number">1</span>,))</span><br><span class="line">        D[n-<span class="number">1</span>] = np.sign(x[<span class="number">0</span>])</span><br><span class="line">        x[<span class="number">0</span>] -= D[n-<span class="number">1</span>]*np.sqrt((x*x).<span class="built_in">sum</span>())</span><br><span class="line">        <span class="comment"># Householder transformation</span></span><br><span class="line">        Hx = (np.eye(dim-n+<span class="number">1</span>) - <span class="number">2.</span>*np.outer(x, x)/(x*x).<span class="built_in">sum</span>())</span><br><span class="line">        mat = np.eye(dim)</span><br><span class="line">        mat[n-<span class="number">1</span>:, n-<span class="number">1</span>:] = Hx</span><br><span class="line">        H = np.dot(H, mat)</span><br><span class="line">        <span class="comment"># Fix the last sign such that the determinant is 1</span></span><br><span class="line">    D[-<span class="number">1</span>] = (-<span class="number">1</span>)**(<span class="number">1</span>-(dim % <span class="number">2</span>))*D.prod()</span><br><span class="line">    <span class="comment"># Equivalent to np.dot(np.diag(D), H) but faster, apparently</span></span><br><span class="line">    H = (D*H.T).T</span><br><span class="line">    <span class="keyword">return</span> H</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line">dim = <span class="number">5</span></span><br><span class="line">A = np.eye(dim)</span><br><span class="line">A[np.diag_indices_from(A)] = np.random.randint(<span class="number">1</span>, <span class="number">5</span>, size=[<span class="number">1</span>, A.shape[<span class="number">0</span>]])</span><br><span class="line">Q = rvs(dim=A.shape[<span class="number">0</span>])</span><br><span class="line">A = Q.T@A@Q</span><br><span class="line">A = (A+A.T)/<span class="number">2</span>+<span class="number">2</span></span><br><span class="line">A = A.<span class="built_in">round</span>(<span class="number">0</span>).astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="built_in">print</span>(A, <span class="string">'\n'</span>)</span><br><span class="line">G = Cholesky(A)</span><br><span class="line"><span class="built_in">print</span>(G.<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[[4. 3. 2. 2. 2.]
 [3. 5. 3. 2. 2.]
 [2. 3. 4. 3. 2.]
 [2. 2. 3. 5. 3.]
 [2. 2. 2. 3. 4.]] 

[[2.   0.   0.   0.   0.  ]
 [1.5  1.66 0.   0.   0.  ]
 [1.   0.9  1.48 0.   0.  ]
 [1.   0.3  1.17 1.59 0.  ]
 [1.   0.3  0.49 0.84 1.4 ]]
</code></pre><h2 id="带状方程组"><a href="#带状方程组" class="headerlink" title="带状方程组"></a>带状方程组</h2><h3 id="带状矩阵的-LU-分解"><a href="#带状矩阵的-LU-分解" class="headerlink" title="带状矩阵的 LU 分解"></a>带状矩阵的 LU 分解</h3><p><strong>定理 4.3.1</strong> 假定 $\mathbf {A}\in\mathbb {R}^{n\times n}$ 有 LU 分解 $\mathbf {A}=\mathbf {LU}$, 如果 $\mathbf {A}$ 的上带宽 $q$，下带宽为 $p$，则 $\mathbf {U}$ 的上带宽为 $q$，$\mathbf {L}$ 的下带宽为 $p$.</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">LU_belt</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="keyword">if</span> A.shape[<span class="number">0</span>] &gt; <span class="number">1</span>:</span><br><span class="line">        L, U = np.zeros_like(A), np.zeros_like(A)</span><br><span class="line">        alpha = A[<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        v = A[<span class="number">1</span>:, <span class="number">0</span>]</span><br><span class="line">        L[<span class="number">0</span>, <span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">        L[<span class="number">1</span>:, <span class="number">0</span>] = v/alpha</span><br><span class="line">        w = A[<span class="number">0</span>, <span class="number">1</span>:]</span><br><span class="line">        U[<span class="number">0</span>, <span class="number">0</span>] = alpha</span><br><span class="line">        U[<span class="number">0</span>, <span class="number">1</span>:] = w</span><br><span class="line">        L[<span class="number">1</span>:, <span class="number">1</span>:], U[<span class="number">1</span>:, <span class="number">1</span>:] = LU_belt(A[<span class="number">1</span>:, <span class="number">1</span>:]-v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*w/alpha)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>, A</span><br><span class="line">    <span class="keyword">return</span> L, U</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">LU_belt(A)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>(array([[1.        , 0.        , 0.        , 0.        , 0.        ],
        [0.75      , 1.        , 0.        , 0.        , 0.        ],
        [0.5       , 0.54545455, 1.        , 0.        , 0.        ],
        [0.5       , 0.18181818, 0.79166667, 1.        , 0.        ],
        [0.5       , 0.18181818, 0.33333333, 0.52459016, 1.        ]]),
 array([[4.        , 3.        , 2.        , 2.        , 2.        ],
        [0.        , 2.75      , 1.5       , 0.5       , 0.5       ],
        [0.        , 0.        , 2.18181818, 1.72727273, 0.72727273],
        [0.        , 0.        , 0.        , 2.54166667, 1.33333333],
        [0.        , 0.        , 0.        , 0.        , 1.96721311]]))
</code></pre><h2 id="对称不定方程组"><a href="#对称不定方程组" class="headerlink" title="对称不定方程组"></a>对称不定方程组</h2><p><strong>对角选主元法</strong>计算置换矩阵 $\mathbf {P}$</p>
<script type="math/tex; mode=display">
\mathbf{PA}\mathbf{P}^T=\mathbf{LT}\mathbf{L}^T</script><h3 id="Parlett-Reid-算法"><a href="#Parlett-Reid-算法" class="headerlink" title="Parlett-Reid 算法"></a>Parlett-Reid 算法</h3><h3 id="Aasen-方法"><a href="#Aasen-方法" class="headerlink" title="Aasen 方法"></a>Aasen 方法</h3><h3 id="选主的-Aasen-方法"><a href="#选主的-Aasen-方法" class="headerlink" title="选主的 Aasen 方法"></a>选主的 Aasen 方法</h3><h2 id="分块方程组"><a href="#分块方程组" class="headerlink" title="分块方程组"></a>分块方程组</h2><h3 id="分块三对角-LU-分解"><a href="#分块三对角-LU-分解" class="headerlink" title="分块三对角 LU 分解"></a>分块三对角 LU 分解</h3><script type="math/tex; mode=display">
\mathbf{A}=\left(\begin{matrix}\mathbf{D}_1&\mathbf{F}_1&\cdots\\\mathbf{E}_1&\mathbf{D}_2\\\vdots\end{matrix}\right)</script><figure class="highlight js"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">U</span>(<span class="number">1</span>) = <span class="title function_">D</span>(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i = <span class="number">2</span>:n</span><br><span class="line">    <span class="title function_">L</span>(i-<span class="number">1</span>)=<span class="title function_">E</span>(i-<span class="number">1</span>)<span class="title class_">InvU</span>(i-<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">U</span>(i)=<span class="title function_">D</span>(i)-<span class="title function_">L</span>(i-<span class="number">1</span>)<span class="title function_">F</span>(i-<span class="number">1</span>)</span><br><span class="line">end</span><br></pre></td></tr></tbody></table></figure>
<h3 id="分块对角占优方程组"><a href="#分块对角占优方程组" class="headerlink" title="分块对角占优方程组"></a>分块对角占优方程组</h3><h3 id="分块解法与带状解法的比较"><a href="#分块解法与带状解法的比较" class="headerlink" title="分块解法与带状解法的比较"></a>分块解法与带状解法的比较</h3><h3 id="Kronecker-积方程"><a href="#Kronecker-积方程" class="headerlink" title="Kronecker 积方程"></a>Kronecker 积方程</h3><script type="math/tex; mode=display">
\mathbf{A}=\mathbf{B}\otimes \mathbf{C}=\left(b_{ij}\mathbf{C}\right)</script><p>有如下性质</p>
<script type="math/tex; mode=display">
(\mathbf{A}\otimes \mathbf{B})(\mathbf{C}\otimes \mathbf{D})=\mathbf{AC}\otimes \mathbf{BD}\\
(\mathbf{A}\otimes \mathbf{B})^T=\mathbf{A}^T\otimes \mathbf{B}^T\\
(\mathbf{A}\otimes \mathbf{B})^{-1}=\mathbf{A}^{-1}\otimes \mathbf{B}^{-1}</script><p>vec 运算</p>
<script type="math/tex; mode=display">
\mathbf{X}\Leftrightarrow\text{vec}(\mathbf{X})=\left(\begin{matrix}X(:,1)\\\vdots\\X(:,n)\end{matrix}\right)</script><p>于是可以证明</p>
<script type="math/tex; mode=display">
\mathbf{Y}=\mathbf{C}\mathbf{X}\mathbf{B}^T\Leftrightarrow \text{vec}(\mathbf{Y})=(\mathbf{B}\otimes\mathbf{C})\text{vec}(\mathbf{X})</script><h2 id="Vandermonde-方程组和-FFT"><a href="#Vandermonde-方程组和-FFT" class="headerlink" title="Vandermonde 方程组和 FFT"></a>Vandermonde 方程组和 FFT</h2><script type="math/tex; mode=display">
\mathbf{V}=\left(\begin{matrix}1&\cdots&1\\x_0&\cdots&x_n\\\vdots&&\vdots\\x_0^n&\cdots&x_n^n\end{matrix}\right)</script><p><strong>本节中的向量和矩阵的下标均从 0 开始标记</strong></p>
<h3 id="多项式插值：-mathbf-V-Ta-f"><a href="#多项式插值：-mathbf-V-Ta-f" class="headerlink" title="多项式插值：$\mathbf{V}^Ta=f$"></a>多项式插值：$\mathbf {V}^Ta=f$</h3><p>$\mathbf {V}^Ta=f$ 可以等价于 $f_i=p (x_i)=\sum_{j=0}^n {a_jx^j_i},\ i=0:n$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">x = np.array([<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">f = np.array([<span class="number">10</span>, <span class="number">26</span>, <span class="number">58</span>, <span class="number">112</span>])</span><br><span class="line">n = <span class="built_in">len</span>(x)-<span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Vandermonde</span>(<span class="params">x, f</span>):</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n, k, -<span class="number">1</span>):</span><br><span class="line">            f[i] = (f[i]-f[i-<span class="number">1</span>])/(x[i]-x[i-k-<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(k, n):</span><br><span class="line">            f[i] -= f[i+<span class="number">1</span>]*x[k]</span><br><span class="line">    <span class="keyword">return</span> f</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = Vandermonde(x, f)</span><br><span class="line"><span class="built_in">print</span>(a)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[4 3 2 1]
</code></pre><h3 id="快速-Fourier-变换"><a href="#快速-Fourier-变换" class="headerlink" title="快速 Fourier 变换"></a>快速 Fourier 变换</h3><p>$n$ 阶离散 Fourier 变换阵 (DFT) 定义为</p>
<script type="math/tex; mode=display">
\mathbf{F}_n=(f_ik),\quad f_{jk}=w_n^{jk}</script><p>其中</p>
<script type="math/tex; mode=display">
w_n=\exp(-2\pi\mathrm{i}/n)=\cos(2\pi/n)-\mathrm{i}\sin(2\pi/n)</script><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> scipy.fftpack <span class="keyword">import</span> fft, ifft</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 采样点选择 1400 个，因为设置的信号频率分量最高为 600 赫兹，根据采样定理知采样频率要大于信号频率 2 倍，所以这里设置采样频率为 1400 赫兹（即一秒内有 1400 个采样点，一样意思的）</span></span><br><span class="line">x = np.linspace(<span class="number">0</span>, <span class="number">1</span>, <span class="number">1400</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置需要采样的信号，频率分量有 180，390 和 600</span></span><br><span class="line">y = <span class="number">7</span>*np.sin(<span class="number">2</span>*np.pi*<span class="number">180</span>*x) + <span class="number">2.8</span>*np.sin(<span class="number">2</span>*np.pi*<span class="number">390</span>*x)+<span class="number">5.1</span> * \</span><br><span class="line">    np.sin(<span class="number">2</span>*np.pi*<span class="number">50</span>*x) + np.random.randn(<span class="built_in">len</span>(x))</span><br><span class="line"></span><br><span class="line">yy = fft(y)  <span class="comment"># 快速傅里叶变换</span></span><br><span class="line">yreal = yy.real               <span class="comment"># 获取实数部分</span></span><br><span class="line">yimag = yy.imag               <span class="comment"># 获取虚数部分</span></span><br><span class="line"></span><br><span class="line">yf = <span class="built_in">abs</span>(fft(y))                <span class="comment"># 取绝对值</span></span><br><span class="line">yf1 = <span class="built_in">abs</span>(fft(y))/<span class="built_in">len</span>(x)  <span class="comment"># 归一化处理</span></span><br><span class="line">yf2 = yf1[<span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(x)/<span class="number">2</span>))]  <span class="comment"># 由于对称性，只取一半区间</span></span><br><span class="line"></span><br><span class="line">xf = np.arange(<span class="built_in">len</span>(y))        <span class="comment"># 频率</span></span><br><span class="line">xf1 = xf</span><br><span class="line">xf2 = xf[<span class="built_in">range</span>(<span class="built_in">int</span>(<span class="built_in">len</span>(x)/<span class="number">2</span>))]  <span class="comment"># 取一半区间</span></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=[<span class="number">12</span>, <span class="number">10</span>])</span><br><span class="line">plt.subplot(<span class="number">221</span>)</span><br><span class="line">plt.plot(x[<span class="number">0</span>:<span class="number">50</span>], y[<span class="number">0</span>:<span class="number">50</span>])</span><br><span class="line">plt.title(<span class="string">'Original wave'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">222</span>)</span><br><span class="line">plt.plot(xf, yf, <span class="string">'r'</span>)</span><br><span class="line">plt.title(<span class="string">'FFT of Mixed wave(two sides frequency range)'</span>,</span><br><span class="line">          fontsize=<span class="number">12</span>, color=<span class="string">'#7A378B'</span>)  <span class="comment"># 注意这里的颜色可以查询颜色代码表</span></span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">223</span>)</span><br><span class="line">plt.plot(xf1, yf1, <span class="string">'g'</span>)</span><br><span class="line">plt.title(<span class="string">'FFT of Mixed wave(normalization)'</span>, fontsize=<span class="number">12</span>, color=<span class="string">'r'</span>)</span><br><span class="line"></span><br><span class="line">plt.subplot(<span class="number">224</span>)</span><br><span class="line">plt.plot(xf2, yf2, <span class="string">'b'</span>)</span><br><span class="line">plt.title(<span class="string">'FFT of Mixed wave)'</span>, fontsize=<span class="number">12</span>, color=<span class="string">'#F08080'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.show()</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<p><img src="Matrixcalculation_files/Matrixcalculation_48_0.png" alt="png"></p>
<h2 id="Toeplitz-方程组"><a href="#Toeplitz-方程组" class="headerlink" title="Toeplitz 方程组"></a>Toeplitz 方程组</h2><p>每条对角线上的元素都相同的矩阵，称为 Toeplitz 矩阵，它属于转对称矩阵，等价于 $\mathbf {B}=\mathbf {E}\mathbf {B}^T\mathbf {E}$，其中 $\mathbf {E}$ 是反对角线上全为 1 的矩阵</p>
<h1 id="正交化和最小二乘法"><a href="#正交化和最小二乘法" class="headerlink" title="正交化和最小二乘法"></a>正交化和最小二乘法</h1><h2 id="Householder-矩阵-和-Givens-矩阵"><a href="#Householder-矩阵-和-Givens-矩阵" class="headerlink" title="Householder 矩阵 和 Givens 矩阵"></a>Householder 矩阵 和 Givens 矩阵</h2><h3 id="一个-2×2-矩阵的引例"><a href="#一个-2×2-矩阵的引例" class="headerlink" title="一个 2×2 矩阵的引例"></a>一个 2×2 矩阵的引例</h3><p>旋转矩阵 $y=\mathbf {Q}^Tx$</p>
<script type="math/tex; mode=display">
\mathbf{Q}=\left(\begin{matrix}\cos\theta&\sin\theta\\-\sin\theta&\cos\theta\end{matrix}\right)</script><p>反射矩阵 $y=\mathbf {Q}^Tx$</p>
<script type="math/tex; mode=display">
\mathbf{Q}=\left(\begin{matrix}\cos\theta&\sin\theta\\\sin\theta&-\cos\theta\end{matrix}\right)</script><h3 id="Householder-反射"><a href="#Householder-反射" class="headerlink" title="Householder 反射"></a>Householder 反射</h3><script type="math/tex; mode=display">
\mathbf{P}=\mathbf{I}-\dfrac{2}{v^Tv}vv^T</script><p>$\mathbf {P} x$ 意味着 $x$ 以向量 $v$ 作对称操作</p>
<h3 id="计算-Householder-向量"><a href="#计算-Householder-向量" class="headerlink" title="计算 Householder 向量"></a>计算 Householder 向量</h3><script type="math/tex; mode=display">
v=x_1-||x||_2=\dfrac{x_1^2-||x||^2_2}{x_1+||x||^2_2}=\dfrac{-(x_2^2+\cdots+x_n^2)}{x_1+||x||^2_2}</script><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">house</span>(<span class="params">x</span>):</span><br><span class="line">    sigma = x[<span class="number">1</span>:]@x[<span class="number">1</span>:]</span><br><span class="line">    v = np.concatenate((np.array([<span class="number">1</span>]), x[<span class="number">1</span>:]))</span><br><span class="line">    <span class="keyword">if</span> sigma == <span class="number">0</span>:</span><br><span class="line">        beta = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mu = np.sqrt(x[<span class="number">0</span>]**<span class="number">2</span> + sigma)</span><br><span class="line">        <span class="keyword">if</span> x[<span class="number">0</span>] &lt;= <span class="number">0</span>:</span><br><span class="line">            v[<span class="number">0</span>] = x[<span class="number">0</span>] - mu</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v[<span class="number">0</span>] = -sigma/(x[<span class="number">0</span>] + mu)</span><br><span class="line">        beta = <span class="number">2</span>*v[<span class="number">0</span>]**<span class="number">2</span>/(sigma + v[<span class="number">0</span>]**<span class="number">2</span>)</span><br><span class="line">        v = v/v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> v, beta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x = np.array([<span class="number">3</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">v, beta = house(x)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'v='</span>, v.<span class="built_in">round</span>(<span class="number">2</span>), <span class="string">'\n'</span>, <span class="string">'beta='</span>, beta.<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">len</span>(x)</span><br><span class="line">P = np.eye(n) - beta*v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*v</span><br><span class="line"><span class="built_in">print</span>(<span class="string">'P='</span>, P.<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>v= [ 1.   -0.33 -1.67 -0.33] 
 beta= 0.5
P= [[ 0.5   0.17  0.83  0.17]
 [ 0.17  0.94 -0.28 -0.06]
 [ 0.83 -0.28 -0.39 -0.28]
 [ 0.17 -0.06 -0.28  0.94]]
</code></pre><h3 id="因子形式表达"><a href="#因子形式表达" class="headerlink" title="因子形式表达"></a>因子形式表达</h3><h3 id="分块形式"><a href="#分块形式" class="headerlink" title="分块形式"></a>分块形式</h3><p><strong>引理 5.1.1</strong> 假定 $\mathbf {Q}=\mathbf {I}+\mathbf {WY}^T$ 是 $n\times n$ 的正交矩阵，其中 $\mathbf {W},\mathbf {Y}\in\mathbb {R}^{n\times j}$，如果 $\mathbf {P}=\mathbf {I}-\beta vv^T$，其中 $v\in\mathbb {R}^{n},z=-\beta\mathbf {Q} v$，则</p>
<script type="math/tex; mode=display">
\mathbf{Q}_+=\mathbf{QP}=\mathbf{I}+\mathbf{W}_+\mathbf{Y}_+^T</script><p>其中 $\mathbf {W}_+=[\mathbf {W}\ z]$ 和 $\mathbf {Y}_+=[\mathbf {Y}\ v]$ 均为 $n\times (j+1)$ 矩阵</p>
<h3 id="Givens-旋转"><a href="#Givens-旋转" class="headerlink" title="Givens 旋转"></a>Givens 旋转</h3><script type="math/tex; mode=display">
\mathbf{G}(i,k,\theta)=\begin{cases}
    \cos\theta,&ii,kk\\
    \sin\theta,&ik\\
    -\sin\theta,&ki\\
    1,&r=c\not ={i,k}\\
    0,&\text{other}
\end{cases}</script><p>若使 $y_k=0$，则有 $c=\dfrac {x_i}{\sqrt {x_i^2+x_k^2}},\quad s = \dfrac {-x_k}{\sqrt {x_i^2+x_k^2}}$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">givens</span>(<span class="params">a, b</span>):</span><br><span class="line">    a = a.astype(<span class="built_in">float</span>)</span><br><span class="line">    b = b.astype(<span class="built_in">float</span>)</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        c, s = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> np.<span class="built_in">abs</span>(b) &gt; np.<span class="built_in">abs</span>(a):</span><br><span class="line">            tau = -a/b</span><br><span class="line">            s = <span class="number">1</span>/np.sqrt(tau**<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            c = s*tau</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tau = -b/a</span><br><span class="line">            c = <span class="number">1</span>/np.sqrt(tau**<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            s = c*tau</span><br><span class="line">    <span class="keyword">return</span> c, s</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h2 id="QR-分解"><a href="#QR-分解" class="headerlink" title="QR 分解"></a>QR 分解</h2><h3 id="Householder-QR-分解"><a href="#Householder-QR-分解" class="headerlink" title="Householder QR 分解"></a>Householder QR 分解</h3><p>$\mathbf{H}_n\cdots\mathbf{H}_1\mathbf{A}=\mathbf{R}\Rightarrow \mathbf{Q}=\mathbf{H}_1\cdots\mathbf{H}_n$</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">house</span>(<span class="params">x</span>):</span><br><span class="line">    sigma = x[<span class="number">1</span>:]@x[<span class="number">1</span>:]</span><br><span class="line">    v = np.concatenate((np.array([<span class="number">1</span>]), x[<span class="number">1</span>:]))</span><br><span class="line">    <span class="keyword">if</span> sigma == <span class="number">0</span>:</span><br><span class="line">        beta = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mu = np.sqrt(x[<span class="number">0</span>]**<span class="number">2</span> + sigma)</span><br><span class="line">        <span class="keyword">if</span> x[<span class="number">0</span>] &lt;= <span class="number">0</span>:</span><br><span class="line">            v[<span class="number">0</span>] = x[<span class="number">0</span>] - mu</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v[<span class="number">0</span>] = -sigma/(x[<span class="number">0</span>] + mu)</span><br><span class="line">        beta = <span class="number">2</span>*v[<span class="number">0</span>]**<span class="number">2</span>/(sigma + v[<span class="number">0</span>]**<span class="number">2</span>)</span><br><span class="line">        v = v/v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> v, beta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">houseQR</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line">    betaj = np.zeros(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v, beta = house(A[j:, j])</span><br><span class="line">        betaj[j] = beta</span><br><span class="line">        A[j:, j:] = (np.eye(m-j)-beta*v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*v)@A[j:, j:]</span><br><span class="line">        <span class="keyword">if</span> j &lt; m - <span class="number">1</span>:</span><br><span class="line">            A[j+<span class="number">1</span>:, j] = v[<span class="number">1</span>:m-j]</span><br><span class="line">    <span class="keyword">return</span> A, betaj</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A = np.random.randint(<span class="number">1</span>, <span class="number">20</span>, size=[<span class="number">6</span>, <span class="number">5</span>])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line">A, beta = houseQR(A)</span><br><span class="line">A.<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[[ 6. 12. 13.  9. 10.]
 [12.  6. 16.  1. 17.]
 [ 2. 13.  8. 14.  7.]
 [19.  6. 19. 12. 11.]
 [15. 19.  5. 10. 18.]
 [ 1. 14. 10. 10.  8.]]





array([[27.77, 21.  , 26.36, 17.36, 27.55],
       [-0.55, 22.39,  6.77, 14.9 , 11.37],
       [-0.09, -0.57, 15.3 ,  4.22,  2.21],
       [-0.87,  0.09, -0.96,  8.99, -6.67],
       [-0.69, -0.6 ,  0.41,  1.49,  3.06],
       [-0.05, -0.64, -1.42,  1.04, -0.41]])
</code></pre><h3 id="分块-Householder-QR-分解"><a href="#分块-Householder-QR-分解" class="headerlink" title="分块 Householder QR 分解"></a>分块 Householder QR 分解</h3><h3 id="Givens-QR-方法"><a href="#Givens-QR-方法" class="headerlink" title="Givens QR 方法"></a>Givens QR 方法</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">givens</span>(<span class="params">a, b</span>):</span><br><span class="line">    a = a.astype(<span class="built_in">float</span>)</span><br><span class="line">    b = b.astype(<span class="built_in">float</span>)</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        c, s = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> np.<span class="built_in">abs</span>(b) &gt; np.<span class="built_in">abs</span>(a):</span><br><span class="line">            tau = -a/b</span><br><span class="line">            s = <span class="number">1</span>/np.sqrt(tau**<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            c = s*tau</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tau = -b/a</span><br><span class="line">            c = <span class="number">1</span>/np.sqrt(tau**<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            s = c*tau</span><br><span class="line">    <span class="keyword">return</span> c, s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">GivensQR</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(m-<span class="number">1</span>, j, -<span class="number">1</span>):</span><br><span class="line">            c, s = givens(A[i-<span class="number">1</span>, j], A[i, j])</span><br><span class="line">            Q = np.array([[c, s], [-s, c]]).T</span><br><span class="line">            A[i-<span class="number">1</span>:i+<span class="number">1</span>, j:] = Q@A[i-<span class="number">1</span>:i+<span class="number">1</span>, j:]</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A = np.random.randint(<span class="number">1</span>, <span class="number">20</span>, size=[<span class="number">6</span>, <span class="number">4</span>])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line">A = GivensQR(A)</span><br><span class="line">A.<span class="built_in">round</span>(<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[[ 6. 12. 13.  9.]
 [10. 12.  6. 16.]
 [ 1. 17.  2. 13.]
 [ 8. 14.  7. 19.]
 [ 6. 19. 12. 11.]
 [15. 19.  5. 10.]]





array([[-21.49, -33.5 , -15.96, -27.68],
       [ -0.  ,  19.31,   7.69,  13.4 ],
       [ -0.  ,   0.  ,  10.64,   0.87],
       [ -0.  ,   0.  ,   0.  ,  11.89],
       [  0.  ,  -0.  ,   0.  ,  -0.  ],
       [ -0.  ,  -0.  ,   0.  ,   0.  ]])
</code></pre><h3 id="利用-Givens-变换的-Hessenberg-QR-分解"><a href="#利用-Givens-变换的-Hessenberg-QR-分解" class="headerlink" title="利用 Givens 变换的 Hessenberg QR 分解"></a>利用 Givens 变换的 Hessenberg QR 分解</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">givens</span>(<span class="params">a, b</span>):</span><br><span class="line">    a = a.astype(<span class="built_in">float</span>)</span><br><span class="line">    b = b.astype(<span class="built_in">float</span>)</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        c, s = <span class="number">1</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">if</span> np.<span class="built_in">abs</span>(b) &gt; np.<span class="built_in">abs</span>(a):</span><br><span class="line">            tau = -a/b</span><br><span class="line">            s = <span class="number">1</span>/np.sqrt(tau**<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            c = s*tau</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            tau = -b/a</span><br><span class="line">            c = <span class="number">1</span>/np.sqrt(tau**<span class="number">2</span> + <span class="number">1</span>)</span><br><span class="line">            s = c*tau</span><br><span class="line">    <span class="keyword">return</span> c, s</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HessenbergQR</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        c, s = givens(A[j, j], A[j+<span class="number">1</span>, j])</span><br><span class="line">        Q = np.array([[c, s], [-s, c]]).T</span><br><span class="line">        A[j:j+<span class="number">2</span>, j:] = Q@A[j:j+<span class="number">2</span>, j:]</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">A = np.random.randint(<span class="number">1</span>, <span class="number">20</span>, size=[<span class="number">6</span>, <span class="number">3</span>])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line"><span class="built_in">print</span>(A)</span><br><span class="line">A = HessenbergQR(A)</span><br><span class="line">A.<span class="built_in">round</span>(<span class="number">2</span>)</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<pre><code>[[ 6. 12. 13.]
 [ 9. 10. 12.]
 [ 6. 16.  1.]
 [17.  2. 13.]
 [ 8. 14.  7.]
 [19.  6. 19.]]





array([[-10.82, -14.98, -17.2 ],
       [  0.  , -16.6 ,  -2.08],
       [  6.  ,   0.  ,   3.74],
       [ 17.  ,   2.  ,  13.  ],
       [  8.  ,  14.  ,   7.  ],
       [ 19.  ,   6.  ,  19.  ]])
</code></pre><h3 id="快速-Givens-QR-分解"><a href="#快速-Givens-QR-分解" class="headerlink" title="快速 Givens QR 分解"></a>快速 Givens QR 分解</h3><h3 id="QR-分解的性质"><a href="#QR-分解的性质" class="headerlink" title="QR 分解的性质"></a>QR 分解的性质</h3><p><strong>定理 5.2.1</strong> 如果 $\mathbf {A}=\mathbf {QR}$ 是一个列满秩矩阵的 QR 分解，且 $\mathbf {A}=[a_1,\cdots,a_n],\mathbf {Q}=[q_1,\cdots,q_n]$ 是一个按列的划分，则</p>
<script type="math/tex; mode=display">
\text{span}\{a_1,\cdots,a_n\}=\text{span}\{q_1,\cdots,q_n\},\quad k=1:n</script><p><strong>定理 5.2.2</strong> 假定 $\mathbf {A}\in\mathbb {R}^{m\times n}$ 是列满秩的，则窄 QR 分解</p>
<script type="math/tex; mode=display">
\mathbf{A}=\mathbf{Q}_1\mathbf{R}_1</script><p>是唯一的，其中 $\mathbf {Q}_1\in\mathbb {R}^{m\times n}$ 的列向量互相正交，$\mathbf {R}_1$ 是对角元素大于 0 的上三角形矩阵。而且 $\mathbf {R}_1=\mathbf {G}^T$，其中 $\mathbf {G}$ 是 $\mathbf {A}^T\mathbf {A}$ 的下三角 Cholesky 因子</p>
<h3 id="经典-Gram-Schmidt-算法"><a href="#经典-Gram-Schmidt-算法" class="headerlink" title="经典 Gram-Schmidt 算法"></a>经典 Gram-Schmidt 算法</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CGS</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    R = np.zeros_like(A)</span><br><span class="line">    Q = np.zeros_like(A)</span><br><span class="line">    R[<span class="number">0</span>,<span class="number">0</span>] = np.linalg.norm(A[:,<span class="number">0</span>])</span><br><span class="line">    Q[:,<span class="number">0</span>] = A[:,<span class="number">0</span>]/R[<span class="number">0</span>,<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,n):</span><br><span class="line">        R[:k,k] = Q[:,:k].T@A[:,k]</span><br><span class="line">        z = A[:,k] - Q[:,:k]@R[:k,k]</span><br><span class="line">        R[k,k] =np.linalg.norm(z)</span><br><span class="line">        <span class="built_in">print</span>((z/R[k,k]).<span class="built_in">round</span>(<span class="number">2</span>))</span><br><span class="line">        Q[:,k] = z/R[k,k]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Q, R</span><br><span class="line"></span><br><span class="line">A = np.random.randint(<span class="number">1</span>, <span class="number">20</span>, size=[<span class="number">6</span>, <span class="number">4</span>])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line">Q, R = CGS(A)</span><br><span class="line">Q.<span class="built_in">round</span>(<span class="number">2</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>[ 0.14 -0.19  0.8   0.08  0.5  -0.23]
[ 0.7   0.   -0.46  0.04  0.35 -0.41]
[-0.1   0.47  0.12  0.64 -0.31 -0.5 ]





array([[ 0.28,  0.14,  0.7 , -0.1 ],
       [ 0.47, -0.19,  0.  ,  0.47],
       [ 0.05,  0.8 , -0.46,  0.12],
       [ 0.37,  0.08,  0.04,  0.64],
       [ 0.28,  0.5 ,  0.35, -0.31],
       [ 0.7 , -0.23, -0.41, -0.5 ]])
</code></pre><h3 id="修正-Gram-Schmidt-算法"><a href="#修正-Gram-Schmidt-算法" class="headerlink" title="修正 Gram-Schmidt 算法"></a>修正 Gram-Schmidt 算法</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MGS</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    R = np.zeros_like(A)</span><br><span class="line">    Q = np.zeros_like(A)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        R[k,k] = np.linalg.norm(A[:,k])</span><br><span class="line">        Q[:,k] = A[:,k]/R[k,k]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k+<span class="number">1</span>,n):</span><br><span class="line">            R[k,j] = Q[:,k]@A[:,j]</span><br><span class="line">            A[:,j] -= Q[:,k]*R[k,j]</span><br><span class="line">    <span class="keyword">return</span> Q, R</span><br><span class="line"></span><br><span class="line">A = np.array([[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1e-3</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1e-3</span>]])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line">Q, R = MGS(A)</span><br><span class="line">Q.<span class="built_in">round</span>(<span class="number">6</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[ 1.00000e+00,  7.07000e-04],
       [ 1.00000e-03, -7.07106e-01],
       [ 0.00000e+00,  7.07107e-01]])
</code></pre><h2 id="满秩的-LS-问题"><a href="#满秩的-LS-问题" class="headerlink" title="满秩的 LS 问题"></a>满秩的 LS 问题</h2><p>如果方程数多于未知量数，称程组 $\mathbf {A} x=b$ 是超定的，超定方程组通常没有精确解，可以适当最小化 $||\mathbf {A} x-b||_p$，给出不同最优解，其中 <strong>最小二乘 (LS)</strong> 问题更容易解决。</p>
<h3 id="满秩的实质"><a href="#满秩的实质" class="headerlink" title="满秩的实质"></a>满秩的实质</h3><p>考虑等式</p>
<script type="math/tex; mode=display">
||\mathbf{A}(x+\alpha z)-b||_2^2=||\mathbf{A}x-b||_2^2+2\alpha z^T\mathbf{A}^T(\mathbf{A}x-b)+\alpha^2||\mathbf{A}z||_2^2</script><p>必然导出第二项 $\mathbf {A}^T (\mathbf {A} x-b)=0$，不然会得出矛盾的结论，这个方程称为 <strong>法方程组</strong></p>
<script type="math/tex; mode=display">
\mathbf{A}^T\mathbf{A}x_{LS}=\mathbf{A}^Tb</script><p>我们称</p>
<script type="math/tex; mode=display">
r_{LS}=b-\mathbf{A}x_{LS}</script><p>为<strong>极小剩余</strong>，用</p>
<script type="math/tex; mode=display">
\rho_{LS}=||\mathbf{A}x_{LS}-b||_2</script><p>表示其大小</p>
<h3 id="法方程组方法"><a href="#法方程组方法" class="headerlink" title="法方程组方法"></a>法方程组方法</h3><p>求解列满秩的 LS 问题应用最广的方法是法方程组法</p>
<p><strong>算法 5.3.1</strong> 给定 $\mathbf {A}\in\mathbb {R}^{m\times n}$ 具有性质 $\text {rank}(\mathbf {A})=n$ 和 $b\in\mathbb {R}^{m}$，本算法计算 LS 问题 $\min||\mathbf {A} x-b||_2$ 的解 $x_{LS}$:</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_forward</span>(<span class="params">L, b</span>):</span><br><span class="line">    L = L.astype(<span class="built_in">float</span>)</span><br><span class="line">    b = b.astype(<span class="built_in">float</span>)</span><br><span class="line">    n = L.shape[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">1</span>):</span><br><span class="line">        b[i] = b[i]/L[i,i]</span><br><span class="line">        b[i+<span class="number">1</span>:] = b[i+<span class="number">1</span>:] - b[i]*L[i+<span class="number">1</span>:,i]</span><br><span class="line">    b[n-<span class="number">1</span>] = b[n-<span class="number">1</span>]/L[n-<span class="number">1</span>,n-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve_backward</span>(<span class="params">U, b</span>):</span><br><span class="line">    U = U.astype(<span class="built_in">float</span>)</span><br><span class="line">    b = b.astype(<span class="built_in">float</span>)</span><br><span class="line">    n = U.shape[<span class="number">0</span>]</span><br><span class="line">    b[n-<span class="number">1</span>] /= U[n-<span class="number">1</span>,n-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">        b[i] = (b[i]-U[i,i+<span class="number">1</span>:]@b[i+<span class="number">1</span>:].reshape(-<span class="number">1</span>, <span class="number">1</span>))/U[i,i]</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Cholesky</span>(<span class="params">A</span>):</span><br><span class="line">    <span class="keyword">if</span> A.shape[<span class="number">0</span>] &gt; <span class="number">1</span>:</span><br><span class="line">        G = np.zeros_like(A)</span><br><span class="line">        alpha = A[<span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">        v = A[<span class="number">1</span>:, <span class="number">0</span>]</span><br><span class="line">        beta = np.sqrt(alpha)</span><br><span class="line">        G[<span class="number">0</span>, <span class="number">0</span>] = beta</span><br><span class="line">        G[<span class="number">1</span>:, <span class="number">0</span>] = v/beta</span><br><span class="line">        G[<span class="number">1</span>:, <span class="number">1</span>:] = Cholesky(A[<span class="number">1</span>:, <span class="number">1</span>:]-v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*v/alpha)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> np.sqrt(A)</span><br><span class="line">    <span class="keyword">return</span> G</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">LS</span>(<span class="params">A,b</span>):</span><br><span class="line">    C = A.T@A</span><br><span class="line">    trilC = np.tril(C)</span><br><span class="line">    d = A.T@b.reshape(-<span class="number">1</span>, <span class="number">1</span>)</span><br><span class="line">    G = Cholesky(C)</span><br><span class="line">    y = solve_forward(G, d)</span><br><span class="line">    x = solve_backward(G.T,y)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">A = np.array([[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1e-3</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1e-3</span>]])</span><br><span class="line">b = np.array([<span class="number">2</span>,<span class="number">1e-3</span>,<span class="number">1e-3</span>])</span><br><span class="line">LS(A, b)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[1.],
       [1.]])
</code></pre><h3 id="用-QR-分解求解-LS-问题"><a href="#用-QR-分解求解-LS-问题" class="headerlink" title="用 QR 分解求解 LS 问题"></a>用 QR 分解求解 LS 问题</h3><script type="math/tex; mode=display">
\mathbf{Q}^T\mathbf{A}=\mathbf{R}=\left(\begin{matrix}\mathbf{R}_1^{(n)}\\0^{(m-n)}\end{matrix}\right)</script><p>是上三角矩阵，如果</p>
<script type="math/tex; mode=display">
\mathbf{Q}^Tb=\left(\begin{matrix}c^{(n)}\\d^{(m-n)}\end{matrix}\right)</script><p>则有</p>
<script type="math/tex; mode=display">
||\mathbf{A}x-b||_2^2=||\mathbf{Q}^T\mathbf{A}x-\mathbf{Q}^Tb||_2^2=||\mathbf{R}_1x-c||_2^2+||d||_2^2</script><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">house</span>(<span class="params">x</span>):</span><br><span class="line">    sigma = x[<span class="number">1</span>:]@x[<span class="number">1</span>:]</span><br><span class="line">    v = np.concatenate((np.array([<span class="number">1</span>]), x[<span class="number">1</span>:]))</span><br><span class="line">    <span class="keyword">if</span> sigma == <span class="number">0</span>:</span><br><span class="line">        beta = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mu = np.sqrt(x[<span class="number">0</span>]**<span class="number">2</span> + sigma)</span><br><span class="line">        <span class="keyword">if</span> x[<span class="number">0</span>] &lt;= <span class="number">0</span>:</span><br><span class="line">            v[<span class="number">0</span>] = x[<span class="number">0</span>] - mu</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v[<span class="number">0</span>] = -sigma/(x[<span class="number">0</span>] + mu)</span><br><span class="line">        beta = <span class="number">2</span>*v[<span class="number">0</span>]**<span class="number">2</span>/(sigma + v[<span class="number">0</span>]**<span class="number">2</span>)</span><br><span class="line">        v = v/v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> v, beta</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">houseQR</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line">    beta_j = np.zeros(n)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v, beta = house(A[j:, j])</span><br><span class="line">        beta_j[j] = beta</span><br><span class="line">        A[j:, j:] = (np.eye(m-j)-beta*v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*v)@A[j:, j:]</span><br><span class="line">        <span class="keyword">if</span> j &lt; m - <span class="number">1</span>:</span><br><span class="line">            A[j+<span class="number">1</span>:, j] = v[<span class="number">1</span>:m-j]</span><br><span class="line">    <span class="keyword">return</span> A, beta_j</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">houseLS</span>(<span class="params">A, b</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line">    v = np.zeros(m)</span><br><span class="line">    A, beta = houseQR(A)</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v[j] = <span class="number">1</span></span><br><span class="line">        v[j+<span class="number">1</span>:] = A[j+<span class="number">1</span>:, j]</span><br><span class="line">        b[j:] = (np.eye(m-j)-beta[j]*v[j:].reshape(-<span class="number">1</span>, <span class="number">1</span>)*v[j:])@(b[j:].reshape(-<span class="number">1</span>,<span class="number">1</span>)).reshape(-<span class="number">1</span>)</span><br><span class="line">    R = np.triu(A,<span class="number">0</span>)[:n,:n]</span><br><span class="line">    c = b[:n]</span><br><span class="line">    x = solve_backward(R,c)</span><br><span class="line">    <span class="keyword">return</span> x</span><br><span class="line"></span><br><span class="line">A = np.array([[<span class="number">1</span>,<span class="number">1</span>],[<span class="number">1e-3</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1e-3</span>]])</span><br><span class="line">b = np.array([<span class="number">2</span>,<span class="number">1e-3</span>,<span class="number">1e-3</span>])</span><br><span class="line">houseLS(A, b)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([1., 1.])
</code></pre><h2 id="其他正交分解"><a href="#其他正交分解" class="headerlink" title="其他正交分解"></a>其他正交分解</h2><h3 id="秩亏损：列选主的-QR-分解"><a href="#秩亏损：列选主的-QR-分解" class="headerlink" title="秩亏损：列选主的 QR 分解"></a>秩亏损：列选主的 QR 分解</h3><script type="math/tex; mode=display">
\mathbf{Q}^T\mathbf{A\Pi}=\left(\begin{matrix}\mathbf{R}_{11}^{(r\times r)}&\mathbf{R}_{12}^{(r\times n-r)}\\0^{(m-r\times r)}&0^{(m-r\times n-r)}\end{matrix}\right)</script><h3 id="完全正交分解"><a href="#完全正交分解" class="headerlink" title="完全正交分解"></a>完全正交分解</h3><h3 id="双对角化"><a href="#双对角化" class="headerlink" title="双对角化"></a>双对角化</h3><script type="math/tex; mode=display">
\mathbf{U}^T_B\mathbf{A}\mathbf{V}_B=(d_i\delta_{ij},f_i\delta_{ij+1}[col=1:n])</script><p>其中 $\mathbf {A}^{(m\times n)},\mathbf {U}_m^{(m\times m)},\mathbf {V}_B^{(n\times n)}$</p>
<p><strong>算法 5.4.2</strong></p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">house</span>(<span class="params">x</span>):</span><br><span class="line">    sigma = x[<span class="number">1</span>:]@x[<span class="number">1</span>:]</span><br><span class="line">    v = np.concatenate((np.array([<span class="number">1</span>]), x[<span class="number">1</span>:]))</span><br><span class="line">    <span class="keyword">if</span> sigma == <span class="number">0</span>:</span><br><span class="line">        beta = <span class="number">0</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        mu = np.sqrt(x[<span class="number">0</span>]**<span class="number">2</span> + sigma)</span><br><span class="line">        <span class="keyword">if</span> x[<span class="number">0</span>] &lt;= <span class="number">0</span>:</span><br><span class="line">            v[<span class="number">0</span>] = x[<span class="number">0</span>] - mu</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            v[<span class="number">0</span>] = -sigma/(x[<span class="number">0</span>] + mu)</span><br><span class="line">        beta = <span class="number">2</span>*v[<span class="number">0</span>]**<span class="number">2</span>/(sigma + v[<span class="number">0</span>]**<span class="number">2</span>)</span><br><span class="line">        v = v/v[<span class="number">0</span>]</span><br><span class="line">    <span class="keyword">return</span> v, beta</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">HouseholderdoubleQR</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        v, beta = house(A[j:,j])</span><br><span class="line">        A[j:,j:] = (np.eye(m-j)-beta*v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*v)@A[j:,j:]</span><br><span class="line">        A[j+<span class="number">1</span>:,j] = v[<span class="number">1</span>:m-j]</span><br><span class="line">        <span class="keyword">if</span> j &lt;= n - <span class="number">3</span>:</span><br><span class="line">            v, beta = house(A[j,j+<span class="number">1</span>:].reshape(-<span class="number">1</span>))</span><br><span class="line">            A[j:,j+<span class="number">1</span>:] = A[j:,j+<span class="number">1</span>:]@(np.eye(n-j-<span class="number">1</span>)-beta*v.reshape(-<span class="number">1</span>, <span class="number">1</span>)*v)</span><br><span class="line">            A[j,j+<span class="number">2</span>:] = v[<span class="number">1</span>:n-j-<span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> A</span><br><span class="line"></span><br><span class="line">A = np.arange(<span class="number">1.</span>,<span class="number">13.</span>).reshape(<span class="number">4</span>,<span class="number">3</span>)</span><br><span class="line">A = HouseholderdoubleQR(A)</span><br><span class="line">A.<span class="built_in">round</span>(<span class="number">3</span>)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>array([[12.884, 21.876, -2.237],
       [-0.337,  2.246, -0.613],
       [-0.589, -2.087,  0.   ],
       [-0.841, -1.448, 59.836]])
</code></pre><h3 id="R-双对角化"><a href="#R-双对角化" class="headerlink" title="R 双对角化"></a>R 双对角化</h3><p>当 $m\gg n$ 时，先 QR 分解，对 $\mathbf {R}_1$ 双对角化，会更快速。</p>
<figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">MGS</span>(<span class="params">A</span>):</span><br><span class="line">    m = A.shape[<span class="number">0</span>]</span><br><span class="line">    n = A.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    R = np.zeros_like(A)</span><br><span class="line">    Q = np.zeros_like(A)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">        R[k,k] = np.linalg.norm(A[:,k])</span><br><span class="line">        Q[:,k] = A[:,k]/R[k,k]</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(k+<span class="number">1</span>,n):</span><br><span class="line">            R[k,j] = Q[:,k]@A[:,j]</span><br><span class="line">            A[:,j] -= Q[:,k]*R[k,j]</span><br><span class="line">    <span class="keyword">return</span> Q, R</span><br><span class="line"></span><br><span class="line">A = np.arange(<span class="number">1.</span>,<span class="number">251.</span>).reshape(<span class="number">50</span>,<span class="number">5</span>)</span><br><span class="line">m = A.shape[<span class="number">0</span>]</span><br><span class="line">n = A.shape[<span class="number">1</span>]</span><br><span class="line">Q,R = MGS(A)</span><br><span class="line">R1 = R[:n,:].copy()</span><br><span class="line">R2 = HouseholderdoubleQR(R1.copy())</span><br><span class="line">pd.DataFrame(R2)</span><br></pre></td></tr></tbody></table></figure>
<div>
<style scoped="">
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1011.397548</td>
      <td>2.053368e+03</td>
      <td>-9.881681e-01</td>
      <td>-9.940622e-01</td>
      <td>-9.999562e-01</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.000000</td>
      <td>1.788795e+01</td>
      <td>7.857435e+00</td>
      <td>2.376284e-01</td>
      <td>3.496478e-03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.000000</td>
      <td>-9.732405e+13</td>
      <td>1.183389e-13</td>
      <td>8.271047e-14</td>
      <td>-3.864627e-01</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.000000</td>
      <td>-1.468457e+13</td>
      <td>6.580129e-02</td>
      <td>5.687740e-14</td>
      <td>1.029767e-14</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.000000</td>
      <td>-2.148016e+13</td>
      <td>-8.632348e-02</td>
      <td>-3.413542e-01</td>
      <td>4.233470e-14</td>
    </tr>
  </tbody>
</table>
</div>



<h2 id="秩亏损的-LS-问题"><a href="#秩亏损的-LS-问题" class="headerlink" title="秩亏损的 LS 问题"></a>秩亏损的 LS 问题</h2><h3 id="极小范数解"><a href="#极小范数解" class="headerlink" title="极小范数解"></a>极小范数解</h3><p>在秩亏损情况下，假设有无穷多个解，就会有</p>
<script type="math/tex; mode=display">
||\mathbf{A}(\lambda x_1+(1-\lambda)x_2)-b||_2\le \min ||\mathbf{A}x-b||_2</script><p>故只存在唯一极小解</p>
<h3 id="完全正交分解和-LS"><a href="#完全正交分解和-LS" class="headerlink" title="完全正交分解和 LS"></a>完全正交分解和 LS</h3><h3 id="SVD-和-LS-问题"><a href="#SVD-和-LS-问题" class="headerlink" title="SVD 和 LS 问题"></a>SVD 和 LS 问题</h3><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> linalg <span class="keyword">as</span> la</span><br><span class="line">np.random.seed(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">A = np.random.randint(<span class="number">1</span>, <span class="number">20</span>, size=[<span class="number">6</span>, <span class="number">5</span>])</span><br><span class="line">A = A.astype(<span class="built_in">float</span>)</span><br><span class="line"></span><br><span class="line">m = A.shape[<span class="number">0</span>]</span><br><span class="line">n = A.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">U, sigma, VT = la.svd(A)</span><br><span class="line"></span><br><span class="line">Q = U.copy()</span><br><span class="line">Z = VT.T.copy()</span><br><span class="line">r = <span class="built_in">len</span>(sigma)</span><br><span class="line"></span><br><span class="line">T11 = np.eye(r)</span><br><span class="line">T11[np.diag_indices_from(T11)] = sigma</span><br><span class="line"></span><br><span class="line">b = np.ones([<span class="number">1</span>,m])</span><br><span class="line">x1 = Z@la.inv(T11)@((Q.T@b.reshape(-<span class="number">1</span>, <span class="number">1</span>))[:r])</span><br><span class="line">la.norm(A@x1-b)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0.03227353907779782
</code></pre><p><strong>定理 5.5.1</strong> 若有 SVD 分解，则</p>
<script type="math/tex; mode=display">
x_{LS}=\sum_{i=1}^r{\dfrac{u_i^Tb}{\sigma_i}v_i}</script><figure class="highlight python"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</span><br><span class="line"><span class="keyword">from</span> numpy <span class="keyword">import</span> linalg <span class="keyword">as</span> la</span><br><span class="line"></span><br><span class="line">b = np.ones([<span class="number">1</span>,m])</span><br><span class="line">m = A.shape[<span class="number">0</span>]</span><br><span class="line">n = A.shape[<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">U, sigma, VT = la.svd(A)</span><br><span class="line"></span><br><span class="line">x2 = np.zeros([r,<span class="number">1</span>])</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(r):</span><br><span class="line">    x2 += (U[:,i]@b.reshape(-<span class="number">1</span>, <span class="number">1</span>)/sigma[i])*((VT.T)[:,i].reshape(-<span class="number">1</span>, <span class="number">1</span>))</span><br><span class="line">la.norm(A@x2-b)</span><br></pre></td></tr></tbody></table></figure>
<pre><code>0.03227353907779823
</code></pre><h3 id="广义逆"><a href="#广义逆" class="headerlink" title="广义逆"></a>广义逆</h3><p>如果我们定义矩阵 $\mathbf {A}^+\in \mathbb {R}^{n\times m}$ 为 $\mathbf {A}^+=\mathbf {V}\mathbf {\Sigma}\mathbf {U}^T$，其中 $\mathbf {\Sigma}^+=\text {diag}\left (\sigma^{-1}_1,\cdots,\sigma^{-1}_r,0,\cdots\right)$，那么 $x_{LS}=\mathbf {A}^+b,\quad \rho_{LS}=||(\mathbf {I}-\mathbf {A}\mathbf {A}^+) b||_2$，则 $\mathbf {A}^+$ 称为 $\mathbf {A}$ 的广义逆。</p>
<p>如果 $r (\mathbf {A})=n\Rightarrow \mathbf {A}^+=(\mathbf {A}^T\mathbf {A})^{-1}\mathbf {A}^T$</p>
<h3 id="列选主的-QR-分解和基本解"><a href="#列选主的-QR-分解和基本解" class="headerlink" title="列选主的 QR 分解和基本解"></a>列选主的 QR 分解和基本解</h3><h2 id="正方形方程组和欠定方程组"><a href="#正方形方程组和欠定方程组" class="headerlink" title="正方形方程组和欠定方程组"></a>正方形方程组和欠定方程组</h2><h3 id="用-QR-分解和-SVD-求解正方形方程组"><a href="#用-QR-分解和-SVD-求解正方形方程组" class="headerlink" title="用 QR 分解和 SVD 求解正方形方程组"></a>用 QR 分解和 SVD 求解正方形方程组</h3><h3 id="欠定方程组"><a href="#欠定方程组" class="headerlink" title="欠定方程组"></a>欠定方程组</h3>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/%E7%9F%A9%E9%98%B5/" rel="tag"># 矩阵</a>
              <a href="/tags/%E6%95%B0%E5%80%BC%E8%AE%A1%E7%AE%97/" rel="tag"># 数值计算</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/919906d6.html" rel="prev" title="Hexo 搭载傻瓜式指南 (2022)">
      <i class="fa fa-chevron-left"></i> Hexo 搭载傻瓜式指南 (2022)
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          
    <div class="comments" id="utterances-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95"><span class="nav-number">1.</span> <span class="nav-text">矩阵乘法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E7%AE%97%E6%B3%95%E4%B8%8E%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.1.</span> <span class="nav-text">基本算法与记号</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.1.1.</span> <span class="nav-text">矩阵记号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E8%BF%90%E7%AE%97"><span class="nav-number">1.1.2.</span> <span class="nav-text">矩阵运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.1.3.</span> <span class="nav-text">向量记号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E8%BF%90%E7%AE%97"><span class="nav-number">1.1.4.</span> <span class="nav-text">向量运算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%82%B9%E7%A7%AF%E5%92%8C-saxpy-%E8%AE%A1%E7%AE%97"><span class="nav-number">1.1.5.</span> <span class="nav-text">点积和 saxpy 计算</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E4%B8%8E%E5%90%91%E9%87%8F%E7%9B%B8%E4%B9%98%E5%92%8C-gaxpy"><span class="nav-number">1.1.6.</span> <span class="nav-text">矩阵与向量相乘和 gaxpy</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E5%88%92%E5%88%86%E6%88%90%E8%A1%8C%E5%92%8C%E5%88%97"><span class="nav-number">1.1.7.</span> <span class="nav-text">矩阵划分成行和列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%92%E5%8F%B7%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.1.8.</span> <span class="nav-text">冒号记号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%96%E7%A7%AF%E4%BF%AE%E6%AD%A3"><span class="nav-number">1.1.9.</span> <span class="nav-text">外积修正</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E4%B8%8E%E7%9F%A9%E9%98%B5%E7%9B%B8%E4%B9%98"><span class="nav-number">1.1.10.</span> <span class="nav-text">矩阵与矩阵相乘</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A0%87%E9%87%8F%E6%8F%8F%E8%BF%B0"><span class="nav-number">1.1.11.</span> <span class="nav-text">标量描述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E6%96%B9%E7%A8%8B"><span class="nav-number">1.1.12.</span> <span class="nav-text">矩阵方程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%9F%A9%E9%98%B5"><span class="nav-number">1.1.13.</span> <span class="nav-text">复矩阵</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E7%BB%93%E6%9E%84"><span class="nav-number">1.2.</span> <span class="nav-text">利用结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E7%8A%B6%E7%9F%A9%E9%98%B5%E5%92%8C-X-0-%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.2.1.</span> <span class="nav-text">带状矩阵和 X-0 记号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E8%A7%92%E7%9F%A9%E9%98%B5"><span class="nav-number">1.2.2.</span> <span class="nav-text">对角矩阵</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E8%A7%92%E5%BD%A2%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95"><span class="nav-number">1.2.3.</span> <span class="nav-text">三角形矩阵乘法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#flop"><span class="nav-number">1.2.4.</span> <span class="nav-text">flop</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%8D%E8%AE%BA%E5%86%92%E5%8F%B7%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.2.5.</span> <span class="nav-text">再论冒号记号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E7%8A%B6%E7%9F%A9%E9%98%B5%E5%AD%98%E5%82%A8"><span class="nav-number">1.2.6.</span> <span class="nav-text">带状矩阵存储</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E7%9F%A9%E9%98%B5%E5%92%8C%E7%AE%97%E6%B3%95"><span class="nav-number">1.3.</span> <span class="nav-text">分块矩阵和算法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E7%9F%A9%E9%98%B5%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.3.1.</span> <span class="nav-text">分块矩阵记号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95"><span class="nav-number">1.3.2.</span> <span class="nav-text">分块矩阵乘法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E7%9F%A9%E9%98%B5%E8%AE%B0%E5%8F%B7"><span class="nav-number">1.3.3.</span> <span class="nav-text">子矩阵记号</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E7%9F%A9%E9%98%B5%E4%B9%98%E5%90%91%E9%87%8F"><span class="nav-number">1.3.4.</span> <span class="nav-text">分块矩阵乘向量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95-1"><span class="nav-number">1.3.5.</span> <span class="nav-text">分块矩阵乘法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%8D%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95"><span class="nav-number">1.3.6.</span> <span class="nav-text">复矩阵乘法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E2%80%9C%E5%88%86%E8%80%8C%E6%B2%BB%E4%B9%8B%E2%80%9D%E7%9F%A9%E9%98%B5%E4%B9%98%E6%B3%95"><span class="nav-number">1.3.7.</span> <span class="nav-text">“分而治之” 矩阵乘法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E5%8C%96%E4%B8%8E%E6%95%B0%E6%8D%AE%E9%87%8D%E5%A4%8D%E4%BD%BF%E7%94%A8"><span class="nav-number">1.4.</span> <span class="nav-text">向量化与数据重复使用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E5%88%86%E6%9E%90"><span class="nav-number">2.</span> <span class="nav-text">矩阵分析</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BA%BF%E6%80%A7%E4%BB%A3%E6%95%B0%E5%88%9D%E6%AD%A5"><span class="nav-number">2.1.</span> <span class="nav-text">线性代数初步</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%8B%AC%E7%AB%8B%EF%BC%8C%E5%AD%90%E7%A9%BA%E9%97%B4%EF%BC%8C%E5%9F%BA%E5%92%8C%E7%BB%B4%E6%95%B0"><span class="nav-number">2.1.1.</span> <span class="nav-text">独立，子空间，基和维数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%9F%EF%BC%8C%E9%9B%B6%E7%A9%BA%E9%97%B4%E5%92%8C%E7%A7%A9"><span class="nav-number">2.1.2.</span> <span class="nav-text">域，零空间和秩</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%86%E7%9F%A9%E9%98%B5"><span class="nav-number">2.1.3.</span> <span class="nav-text">逆矩阵</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C%E5%88%97%E5%BC%8F"><span class="nav-number">2.1.4.</span> <span class="nav-text">行列式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BE%AE%E5%88%86"><span class="nav-number">2.1.5.</span> <span class="nav-text">微分</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E8%8C%83%E6%95%B0"><span class="nav-number">2.2.</span> <span class="nav-text">向量范数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89"><span class="nav-number">2.2.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E9%87%8F%E8%8C%83%E6%95%B0%E6%80%A7%E8%B4%A8"><span class="nav-number">2.2.2.</span> <span class="nav-text">向量范数性质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%9D%E5%AF%B9%E8%AF%AF%E5%B7%AE%E5%92%8C%E7%9B%B8%E5%AF%B9%E8%AF%AF%E5%B7%AE"><span class="nav-number">2.2.3.</span> <span class="nav-text">绝对误差和相对误差</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E8%8C%83%E6%95%B0"><span class="nav-number">2.3.</span> <span class="nav-text">矩阵范数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%B9%89-1"><span class="nav-number">2.3.1.</span> <span class="nav-text">定义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5%E8%8C%83%E6%95%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%A7%E8%B4%A8"><span class="nav-number">2.3.2.</span> <span class="nav-text">矩阵范数的一些性质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9F%A9%E9%98%B5-2-%E8%8C%83%E6%95%B0"><span class="nav-number">2.3.3.</span> <span class="nav-text">矩阵 2 范数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%B0%E5%8A%A8%E4%B8%8E%E9%80%86%E7%9F%A9%E9%98%B5"><span class="nav-number">2.3.4.</span> <span class="nav-text">扰动与逆矩阵</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%9C%89%E9%99%90%E7%B2%BE%E5%BA%A6%E7%9F%A9%E9%98%B5%E8%AE%A1%E7%AE%97"><span class="nav-number">2.4.</span> <span class="nav-text">有限精度矩阵计算</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E4%BA%A4%E5%8C%96%E4%B8%8E-SVD"><span class="nav-number">2.5.</span> <span class="nav-text">正交化与 SVD</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E4%BA%A4%E6%80%A7"><span class="nav-number">2.5.1.</span> <span class="nav-text">正交性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8C%83%E6%95%B0%E5%92%8C%E6%AD%A3%E4%BA%A4%E5%8F%98%E6%8D%A2"><span class="nav-number">2.5.2.</span> <span class="nav-text">范数和正交变换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A5%87%E5%BC%82%E5%80%BC%E5%88%86%E8%A7%A3"><span class="nav-number">2.5.3.</span> <span class="nav-text">奇异值分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%86-SVD"><span class="nav-number">2.5.4.</span> <span class="nav-text">细 SVD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A7%A9%E4%BA%8F%E6%8D%9F%E4%B8%8E-SVD"><span class="nav-number">2.5.5.</span> <span class="nav-text">秩亏损与 SVD</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%89%E7%9F%A9%E9%98%B5"><span class="nav-number">2.5.6.</span> <span class="nav-text">酉矩阵</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8A%95%E5%BD%B1%E4%B8%8E-CS-%E5%88%86%E8%A7%A3"><span class="nav-number">2.6.</span> <span class="nav-text">投影与 CS 分解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E4%BA%A4%E6%8A%95%E5%BD%B1"><span class="nav-number">2.6.1.</span> <span class="nav-text">正交投影</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SVD-%E7%9B%B8%E5%85%B3%E7%9A%84%E6%8A%95%E5%BD%B1"><span class="nav-number">2.6.2.</span> <span class="nav-text">SVD 相关的投影</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AD%90%E7%A9%BA%E9%97%B4%E4%B9%8B%E9%97%B4%E7%9A%84%E8%B7%9D%E7%A6%BB"><span class="nav-number">2.6.3.</span> <span class="nav-text">子空间之间的距离</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#CS-%E5%88%86%E8%A7%A3"><span class="nav-number">2.6.4.</span> <span class="nav-text">CS 分解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E6%96%B9%E5%BD%A2%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84%E7%9A%84%E6%95%8F%E6%84%9F%E6%80%A7"><span class="nav-number">2.7.</span> <span class="nav-text">正方形线性方程组的敏感性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#SVD-%E5%88%86%E6%9E%90"><span class="nav-number">2.7.1.</span> <span class="nav-text">SVD 分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9D%A1%E4%BB%B6"><span class="nav-number">2.7.2.</span> <span class="nav-text">条件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A1%8C%E5%88%97%E5%BC%8F%E4%B8%8E%E9%9D%A0%E8%BF%91%E5%A5%87%E5%BC%82%E7%9A%84%E7%A8%8B%E5%BA%A6"><span class="nav-number">2.7.3.</span> <span class="nav-text">行列式与靠近奇异的程度</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA%E7%B2%BE%E7%A1%AE%E7%9A%84%E8%8C%83%E6%95%B0%E7%95%8C"><span class="nav-number">2.7.4.</span> <span class="nav-text">一个精确的范数界</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E5%85%B3%E4%BA%8E%E5%88%86%E9%87%8F%E7%9A%84%E7%B2%BE%E7%A1%AE%E7%95%8C"><span class="nav-number">2.7.5.</span> <span class="nav-text">一些关于分量的精确界</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E8%88%AC%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">3.</span> <span class="nav-text">一般线性方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E8%A7%92%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">3.1.</span> <span class="nav-text">三角方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E5%89%8D%E6%B6%88%E5%8E%BB%E6%B3%95"><span class="nav-number">3.1.1.</span> <span class="nav-text">向前消去法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%91%E5%90%8E%E6%B6%88%E5%8E%BB%E6%B3%95"><span class="nav-number">3.1.2.</span> <span class="nav-text">向后消去法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%88%97%E7%9A%84%E5%BD%A2%E5%BC%8F"><span class="nav-number">3.1.3.</span> <span class="nav-text">基于列的形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E5%8F%B3%E7%AB%AF%E9%A1%B9%E9%97%AE%E9%A2%98"><span class="nav-number">3.1.4.</span> <span class="nav-text">多右端项问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-%E7%BA%A7%E6%AF%94%E4%BE%8B"><span class="nav-number">3.1.5.</span> <span class="nav-text">3 级比例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B1%82%E8%A7%A3%E9%9D%9E%E6%96%B9%E7%9A%84%E4%B8%89%E8%A7%92%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">3.1.6.</span> <span class="nav-text">求解非方的三角方程组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8D%95%E4%BD%8D%E4%B8%89%E8%A7%92%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">3.1.7.</span> <span class="nav-text">单位三角方程组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%89%E8%A7%92%E5%BD%A2%E7%9F%A9%E9%98%B5%E7%9A%84%E4%BB%A3%E6%95%B0"><span class="nav-number">3.1.8.</span> <span class="nav-text">三角形矩阵的代数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LU-%E5%88%86%E8%A7%A3"><span class="nav-number">3.2.</span> <span class="nav-text">LU 分解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AB%98%E6%96%AF%E5%8F%98%E6%8D%A2"><span class="nav-number">3.2.1.</span> <span class="nav-text">高斯变换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E7%94%A8%E9%AB%98%E6%96%AF%E5%8F%98%E6%8D%A2"><span class="nav-number">3.2.2.</span> <span class="nav-text">作用高斯变换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%AB%98%E6%96%AF%E5%8F%98%E6%8D%A2%E7%9A%84%E8%88%8D%E5%85%A5%E8%AF%AF%E5%B7%AE%E6%80%A7%E8%B4%A8"><span class="nav-number">3.2.3.</span> <span class="nav-text">高斯变换的舍入误差性质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%8A%E4%B8%89%E8%A7%92%E5%BD%A2%E5%8C%96"><span class="nav-number">3.2.4.</span> <span class="nav-text">上三角形化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LU-%E5%88%86%E8%A7%A3-1"><span class="nav-number">3.2.5.</span> <span class="nav-text">LU 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">3.2.6.</span> <span class="nav-text">解线性方程组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97-LU"><span class="nav-number">3.2.7.</span> <span class="nav-text">分块 LU</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%AB%98%E6%96%AF%E6%B6%88%E5%8E%BB%E6%B3%95%E7%9A%84%E8%88%8D%E5%85%A5%E8%AF%AF%E5%B7%AE%E5%88%86%E6%9E%90"><span class="nav-number">3.3.</span> <span class="nav-text">高斯消去法的舍入误差分析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LU-%E5%88%86%E8%A7%A3%E7%9A%84%E8%AF%AF%E5%B7%AE"><span class="nav-number">3.3.1.</span> <span class="nav-text">LU 分解的误差</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E7%B2%BE%E7%A1%AE%E4%B8%89%E8%A7%92%E6%96%B9%E7%A8%8B%E7%BB%84%E7%9A%84%E6%B1%82%E8%A7%A3"><span class="nav-number">3.3.2.</span> <span class="nav-text">非精确三角方程组的求解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E9%80%89%E4%B8%BB%E5%85%83%E6%B3%95"><span class="nav-number">3.4.</span> <span class="nav-text">选主元法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%AE%E6%8D%A2%E7%9F%A9%E9%98%B5"><span class="nav-number">3.4.1.</span> <span class="nav-text">置换矩阵</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E9%80%89%E4%B8%BB%E5%85%83%EF%BC%9A%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3"><span class="nav-number">3.4.2.</span> <span class="nav-text">列选主元：基本思想</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E9%80%89%E4%B8%BB%E5%85%83%EF%BC%9A%E7%BB%86%E8%8A%82"><span class="nav-number">3.4.3.</span> <span class="nav-text">列选主元：细节</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E7%BA%BF%E6%80%A7%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.</span> <span class="nav-text">特殊线性方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#LDM-T-%E5%92%8C-LDL-T-%E5%88%86%E8%A7%A3"><span class="nav-number">4.1.</span> <span class="nav-text">$LDM^T$ 和 $LDL^T$ 分解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#LDM-T-%E5%88%86%E8%A7%A3"><span class="nav-number">4.1.1.</span> <span class="nav-text">$LDM^T$ 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E7%A7%B0%E6%80%A7%E5%92%8C-LDL-T-%E5%88%86%E8%A7%A3"><span class="nav-number">4.1.2.</span> <span class="nav-text">对称性和 $LDL^T$ 分解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E5%AE%9A%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.2.</span> <span class="nav-text">正定方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AD%A3%E5%AE%9A%E6%80%A7"><span class="nav-number">4.2.1.</span> <span class="nav-text">正定性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%9E%E5%AF%B9%E7%A7%B0%E6%AD%A3%E5%AE%9A%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.2.2.</span> <span class="nav-text">非对称正定方程组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AF%B9%E7%A7%B0%E6%AD%A3%E5%AE%9A%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.2.3.</span> <span class="nav-text">对称正定方程组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E4%BA%8E%E5%A4%96%E7%A7%AF%E7%9A%84-Cholesky-%E5%88%86%E8%A7%A3"><span class="nav-number">4.2.4.</span> <span class="nav-text">基于外积的 Cholesky 分解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%B8%A6%E7%8A%B6%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.3.</span> <span class="nav-text">带状方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%A6%E7%8A%B6%E7%9F%A9%E9%98%B5%E7%9A%84-LU-%E5%88%86%E8%A7%A3"><span class="nav-number">4.3.1.</span> <span class="nav-text">带状矩阵的 LU 分解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AF%B9%E7%A7%B0%E4%B8%8D%E5%AE%9A%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.4.</span> <span class="nav-text">对称不定方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Parlett-Reid-%E7%AE%97%E6%B3%95"><span class="nav-number">4.4.1.</span> <span class="nav-text">Parlett-Reid 算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Aasen-%E6%96%B9%E6%B3%95"><span class="nav-number">4.4.2.</span> <span class="nav-text">Aasen 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E4%B8%BB%E7%9A%84-Aasen-%E6%96%B9%E6%B3%95"><span class="nav-number">4.4.3.</span> <span class="nav-text">选主的 Aasen 方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.5.</span> <span class="nav-text">分块方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E4%B8%89%E5%AF%B9%E8%A7%92-LU-%E5%88%86%E8%A7%A3"><span class="nav-number">4.5.1.</span> <span class="nav-text">分块三对角 LU 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E5%AF%B9%E8%A7%92%E5%8D%A0%E4%BC%98%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.5.2.</span> <span class="nav-text">分块对角占优方程组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E8%A7%A3%E6%B3%95%E4%B8%8E%E5%B8%A6%E7%8A%B6%E8%A7%A3%E6%B3%95%E7%9A%84%E6%AF%94%E8%BE%83"><span class="nav-number">4.5.3.</span> <span class="nav-text">分块解法与带状解法的比较</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Kronecker-%E7%A7%AF%E6%96%B9%E7%A8%8B"><span class="nav-number">4.5.4.</span> <span class="nav-text">Kronecker 积方程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vandermonde-%E6%96%B9%E7%A8%8B%E7%BB%84%E5%92%8C-FFT"><span class="nav-number">4.6.</span> <span class="nav-text">Vandermonde 方程组和 FFT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%8F%92%E5%80%BC%EF%BC%9A-mathbf-V-Ta-f"><span class="nav-number">4.6.1.</span> <span class="nav-text">多项式插值：$\mathbf {V}^Ta&#x3D;f$</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F-Fourier-%E5%8F%98%E6%8D%A2"><span class="nav-number">4.6.2.</span> <span class="nav-text">快速 Fourier 变换</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Toeplitz-%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">4.7.</span> <span class="nav-text">Toeplitz 方程组</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%AD%A3%E4%BA%A4%E5%8C%96%E5%92%8C%E6%9C%80%E5%B0%8F%E4%BA%8C%E4%B9%98%E6%B3%95"><span class="nav-number">5.</span> <span class="nav-text">正交化和最小二乘法</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Householder-%E7%9F%A9%E9%98%B5-%E5%92%8C-Givens-%E7%9F%A9%E9%98%B5"><span class="nav-number">5.1.</span> <span class="nav-text">Householder 矩阵 和 Givens 矩阵</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B8%80%E4%B8%AA-2%C3%972-%E7%9F%A9%E9%98%B5%E7%9A%84%E5%BC%95%E4%BE%8B"><span class="nav-number">5.1.1.</span> <span class="nav-text">一个 2×2 矩阵的引例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Householder-%E5%8F%8D%E5%B0%84"><span class="nav-number">5.1.2.</span> <span class="nav-text">Householder 反射</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97-Householder-%E5%90%91%E9%87%8F"><span class="nav-number">5.1.3.</span> <span class="nav-text">计算 Householder 向量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%A0%E5%AD%90%E5%BD%A2%E5%BC%8F%E8%A1%A8%E8%BE%BE"><span class="nav-number">5.1.4.</span> <span class="nav-text">因子形式表达</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97%E5%BD%A2%E5%BC%8F"><span class="nav-number">5.1.5.</span> <span class="nav-text">分块形式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Givens-%E6%97%8B%E8%BD%AC"><span class="nav-number">5.1.6.</span> <span class="nav-text">Givens 旋转</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#QR-%E5%88%86%E8%A7%A3"><span class="nav-number">5.2.</span> <span class="nav-text">QR 分解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Householder-QR-%E5%88%86%E8%A7%A3"><span class="nav-number">5.2.1.</span> <span class="nav-text">Householder QR 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%86%E5%9D%97-Householder-QR-%E5%88%86%E8%A7%A3"><span class="nav-number">5.2.2.</span> <span class="nav-text">分块 Householder QR 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Givens-QR-%E6%96%B9%E6%B3%95"><span class="nav-number">5.2.3.</span> <span class="nav-text">Givens QR 方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A9%E7%94%A8-Givens-%E5%8F%98%E6%8D%A2%E7%9A%84-Hessenberg-QR-%E5%88%86%E8%A7%A3"><span class="nav-number">5.2.4.</span> <span class="nav-text">利用 Givens 变换的 Hessenberg QR 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E9%80%9F-Givens-QR-%E5%88%86%E8%A7%A3"><span class="nav-number">5.2.5.</span> <span class="nav-text">快速 Givens QR 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#QR-%E5%88%86%E8%A7%A3%E7%9A%84%E6%80%A7%E8%B4%A8"><span class="nav-number">5.2.6.</span> <span class="nav-text">QR 分解的性质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%8F%E5%85%B8-Gram-Schmidt-%E7%AE%97%E6%B3%95"><span class="nav-number">5.2.7.</span> <span class="nav-text">经典 Gram-Schmidt 算法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%AE%E6%AD%A3-Gram-Schmidt-%E7%AE%97%E6%B3%95"><span class="nav-number">5.2.8.</span> <span class="nav-text">修正 Gram-Schmidt 算法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%BB%A1%E7%A7%A9%E7%9A%84-LS-%E9%97%AE%E9%A2%98"><span class="nav-number">5.3.</span> <span class="nav-text">满秩的 LS 问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%BB%A1%E7%A7%A9%E7%9A%84%E5%AE%9E%E8%B4%A8"><span class="nav-number">5.3.1.</span> <span class="nav-text">满秩的实质</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B3%95%E6%96%B9%E7%A8%8B%E7%BB%84%E6%96%B9%E6%B3%95"><span class="nav-number">5.3.2.</span> <span class="nav-text">法方程组方法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8-QR-%E5%88%86%E8%A7%A3%E6%B1%82%E8%A7%A3-LS-%E9%97%AE%E9%A2%98"><span class="nav-number">5.3.3.</span> <span class="nav-text">用 QR 分解求解 LS 问题</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E6%AD%A3%E4%BA%A4%E5%88%86%E8%A7%A3"><span class="nav-number">5.4.</span> <span class="nav-text">其他正交分解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A7%A9%E4%BA%8F%E6%8D%9F%EF%BC%9A%E5%88%97%E9%80%89%E4%B8%BB%E7%9A%84-QR-%E5%88%86%E8%A7%A3"><span class="nav-number">5.4.1.</span> <span class="nav-text">秩亏损：列选主的 QR 分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E6%AD%A3%E4%BA%A4%E5%88%86%E8%A7%A3"><span class="nav-number">5.4.2.</span> <span class="nav-text">完全正交分解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8F%8C%E5%AF%B9%E8%A7%92%E5%8C%96"><span class="nav-number">5.4.3.</span> <span class="nav-text">双对角化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#R-%E5%8F%8C%E5%AF%B9%E8%A7%92%E5%8C%96"><span class="nav-number">5.4.4.</span> <span class="nav-text">R 双对角化</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%A7%A9%E4%BA%8F%E6%8D%9F%E7%9A%84-LS-%E9%97%AE%E9%A2%98"><span class="nav-number">5.5.</span> <span class="nav-text">秩亏损的 LS 问题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9E%81%E5%B0%8F%E8%8C%83%E6%95%B0%E8%A7%A3"><span class="nav-number">5.5.1.</span> <span class="nav-text">极小范数解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%8C%E5%85%A8%E6%AD%A3%E4%BA%A4%E5%88%86%E8%A7%A3%E5%92%8C-LS"><span class="nav-number">5.5.2.</span> <span class="nav-text">完全正交分解和 LS</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SVD-%E5%92%8C-LS-%E9%97%AE%E9%A2%98"><span class="nav-number">5.5.3.</span> <span class="nav-text">SVD 和 LS 问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B9%BF%E4%B9%89%E9%80%86"><span class="nav-number">5.5.4.</span> <span class="nav-text">广义逆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%97%E9%80%89%E4%B8%BB%E7%9A%84-QR-%E5%88%86%E8%A7%A3%E5%92%8C%E5%9F%BA%E6%9C%AC%E8%A7%A3"><span class="nav-number">5.5.5.</span> <span class="nav-text">列选主的 QR 分解和基本解</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%AD%A3%E6%96%B9%E5%BD%A2%E6%96%B9%E7%A8%8B%E7%BB%84%E5%92%8C%E6%AC%A0%E5%AE%9A%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">5.6.</span> <span class="nav-text">正方形方程组和欠定方程组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%94%A8-QR-%E5%88%86%E8%A7%A3%E5%92%8C-SVD-%E6%B1%82%E8%A7%A3%E6%AD%A3%E6%96%B9%E5%BD%A2%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">5.6.1.</span> <span class="nav-text">用 QR 分解和 SVD 求解正方形方程组</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%AC%A0%E5%AE%9A%E6%96%B9%E7%A8%8B%E7%BB%84"><span class="nav-number">5.6.2.</span> <span class="nav-text">欠定方程组</span></a></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="結凪"
      src="/images/U_avatar.jpg">
  <p class="site-author-name" itemprop="name">結凪</p>
  <div class="site-description" itemprop="description">如果你想走到高处，就要使用自己的两条腿！</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">文章</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">9</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">17</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/UynajGI" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;UynajGI" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="/suquan12148@outlook.com" title="E-Mail → suquan12148@outlook.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>
  <div class="cc-license motion-element" itemprop="license">
    <a href="https://creativecommons.org/licenses/by-nc/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/cc-by-nc.svg" alt="Creative Commons"></a>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        
  <div class="beian"><a href="https://beian.miit.gov.cn/" rel="noopener" target="_blank">粤 ICP 备 2022065599 号 </a>
      <img src="/images/beian.png" style="display: inline-block;">
  </div>

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">結凪</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var canonicalURL, curProtocol;
      //Get the <link> tag
      var x=document.getElementsByTagName("link");
		//Find the last canonical URL
		if(x.length > 0){
			for (i=0;i<x.length;i++){
				if(x[i].rel.toLowerCase() == 'canonical' && x[i].href){
					canonicalURL=x[i].href;
				}
			}
		}
    //Get protocol
	    if (!canonicalURL){
	    	curProtocol = window.location.protocol.split(':')[0];
	    }
	    else{
	    	curProtocol = canonicalURL.split(':')[0];
	    }
      //Get current URL if the canonical URL does not exist
	    if (!canonicalURL) canonicalURL = window.location.href;
	    //Assign script content. Replace current URL with the canonical URL
      !function(){var e=/([http|https]:\/\/[a-zA-Z0-9\_\.]+\.baidu\.com)/gi,r=canonicalURL,t=document.referrer;if(!e.test(r)){var n=(String(curProtocol).toLowerCase() === 'https')?"https://sp0.baidu.com/9_Q4simg2RQJ8t7jm9iCKT-xh_/s.gif":"//api.share.baidu.com/s.gif";t?(n+="?r="+encodeURIComponent(document.referrer),r&&(n+="&l="+r)):r&&(n+="?l="+r);var i=new Image;i.src=n}}(window);})();
  </script>
















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
          load: ['[tex]/mhchem'],
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
          packages: {'[+]': ['mhchem']},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = 'https://cdn.bootcdn.net/ajax/libs/mathjax/3.2.2/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  

<script>
NexT.utils.loadComments(document.querySelector('#utterances-container'), () => {
    // if (typeof parcelRequire === 'function') { return; }
    var js = document.createElement('script');
    js.type = 'text/javascript';
    js.src = 'https://utteranc.es/client.js';
    js.async = true;
    js.crossorigin = 'anonymous';
    js.setAttribute('repo', 'UynajGI/UynajGI-s-Comment');
    js.setAttribute('issue-term', 'pathname');
    js.setAttribute('theme', 'github-light');
    document.getElementById('utterances-container').appendChild(js);
});
</script>

</body>
</html>
